<? if(!defined("B_PROLOG_INCLUDED") || B_PROLOG_INCLUDED!==true)die(); ?><? IncludeModuleLangFile(__FILE__) ?><tr>	<td colspan="2">		<div class="block-title block-title-first">			<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_LIST_HEADER")?></div>		</div>	</td></tr><tr>	<td style="width:350px;"><?=GetMessage("SOFTEFFECT_XLS_CHANGE_LIST")?></td>	<td>		<select name="XLS_LIST" style="min-width:200px;">			<? foreach ($XlsExcel->getAllSheets() as $index=>$Sheet) { ?>				<option value="<?=$index?>" <?if ($XLS_LIST == $index) echo 'selected'?>><?=$XlsExcel->iconv($Sheet->getTitle())?></option>			<? } ?>		</select>	</td></tr><tr>	<td colspan="2">		<div class="block-title">			<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_FIRST_HEADER")?></div>		</div>	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_FIRST_ROW_COLUMN_HEADER")?></td>	<td>		<div class="box-select-descr box-select-descr-rowcols">			<input type="text" name="XLS_FIRST_ROW_HEADER" class="input-col-row" value="<?=htmlspecialcharsbx($XLS_FIRST_ROW_HEADER)?>" autocomplete="off" /> / <input type="text" name="XLS_FIRST_COLUMN_HEADER" class="input-col-row" value="<?=htmlspecialcharsbx($XLS_FIRST_COLUMN_HEADER)?>" autocomplete="off" />		</div>		<img src="/bitrix/images/softeffect.xls/col_row_header.jpg" alt="" />	</td></tr><tr>	<td colspan="2">		<div class="block-title">			<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_FIRST_DATA")?></div>		</div>	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_FIRST_ROW_COLUMN_DATA")?></td>	<td>		<div class="box-select-descr box-select-descr-rowcols">			<input type="text" name="XLS_FIRST_ROW" class="input-col-row" value="<?=htmlspecialcharsbx($XLS_FIRST_ROW)?>" autocomplete="off" /> / <input type="text" name="XLS_FIRST_COLUMN" class="input-col-row" value="<?=htmlspecialcharsbx($XLS_FIRST_COLUMN)?>" autocomplete="off" />		</div>		<img src="/bitrix/images/softeffect.xls/col_row_data.jpg" alt="" />	</td></tr><tr>	<td colspan="2">		<div class="block-title">			<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_DEPTH_LEVEL")?></div>		</div>	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_DEPTH_LEVEL_MAX")?></td>	<td>		<input type="text" name="XLS_DEPTH_LEVEL_MAX" value="<?=htmlspecialcharsbx($XLS_DEPTH_LEVEL_MAX)?>" class="input-max-depth" autocomplete="off" placeholder="<?=GetMessage("SOFTEFFECT_XLS_EXAMPLE_ONE")?>">	</td></tr><tr>	<td colspan="2">		<div class="block-title">			<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_ELEMENTS")?></div>		</div>	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_DEACTIVATE_ELEMENTS")?></td>	<td>		<input type="checkbox" name="XLS_DEACTIVATE_ELEMENTS" <? if ($XLS_DEACTIVATE_ELEMENTS=='on') { ?>checked="checked"<? } ?>>	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_PROPERTY_SEPARATOR")?></td>	<td>		<input type="text" name="XLS_PROPERTY_SEPARATOR" value="<? if ($XLS_PROPERTY_SEPARATOR) { echo $XLS_PROPERTY_SEPARATOR; } else { echo ";";}?>" class="input-col-row" autocomplete="off">	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE")?></td>	<td>		<table>			<col width="258"/>			<col />			<tr>				<td>					<select name="XLS_STEP4_MODE" id="XLS_STEP4_MODE" onchange="setStep4Descr(this.value);">						<option value="1"<? if ($XLS_STEP4_MODE=='1') { ?> selected="selected"<? } ?>><?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V1")?></option>						<option value="2"<? if ($XLS_STEP4_MODE=='2') { ?> selected="selected"<? } ?>><?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V2")?></option>						<option value="3"<? if ($XLS_STEP4_MODE=='3') { ?> selected="selected"<? } ?>><?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V3")?></option>					</select>				</td>				<td>					<div id="XLS_STEP4_MODE_DESCR"><?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V".$XLS_STEP4_MODE."_DESCR")?></div>					<?/*<div id="XLS_STEP4_MODE_REQUIRE"><?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_REQUIRE")?></div>*/?>				</td>			</tr>		</table>		<script type="text/javascript">			var step4Descr = {				'1': '<?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V1_DESCR")?>',				'2': '<?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V2_DESCR")?>',				'3': '<?=GetMessage("SOFTEFFECT_XLS_STEP4_MODE_V3_DESCR")?>',			}			function setStep4Descr(val) {				var elem = document.getElementById('XLS_STEP4_MODE_DESCR');				elem.innerHTML=step4Descr[val];			}		</script>	</td></tr><tr>	<td colspan="2">		<div class="block-title">			<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_STEP5_PARAMS")?></div>		</div>	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_STEP5_CHUNKSIZE")?></td>	<td>		<input type="text" name="XLS_STEP5_CHUNKSIZE" value="<? if ($XLS_STEP5_CHUNKSIZE) { echo $XLS_STEP5_CHUNKSIZE; } else { echo "100"; } ?>" class="input-col-row" autocomplete="off">	</td></tr><tr>	<td><?=GetMessage("SOFTEFFECT_XLS_STEP5_TIMEOUT")?></td>	<td>		<input type="text" name="XLS_STEP5_TIMEOUT" value="<? if ($XLS_STEP5_TIMEOUT) { echo $XLS_STEP5_TIMEOUT; } else { echo "5"; } ?>" class="input-col-row" autocomplete="off">&nbsp;<b><?=GetMessage("SOFTEFFECT_XLS_STEP5_TIMEOUT_SEC")?></b>	</td></tr><? if ($XLS_IBLOCK_IS_CATALOG) { ?>	<tr>		<td colspan="2">			<div class="block-title">				<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_PRICE_PARAMS")?></div>			</div>		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_PRICE_PARAM_CURRENCY")?></td>		<td valign="midddle">			<table>				<col width="173"/>				<col />				<tr>					<td>						<select name="XLS_PRICE_PARAM_CURRENCY">						<?						$dbCurrencies = CCurrency::GetList();						while ($arCurrency = $dbCurrencies->GetNext()) {							?>							<option value="<?=$arCurrency['CURRENCY']?>" <?if ($XLS_PRICE_PARAM_CURRENCY == $arCurrency['CURRENCY']) echo 'selected'?>><?=$arCurrency['FULL_NAME'].' ['.$arCurrency['CURRENCY'].']'?></option>							<?						}						?>						</select>					</td>					<td>						<?=GetMessage("SOFTEFFECT_XLS_PRICE_PARAM_CURRENCY_DESCR")?>					</td>				</tr>			</table>		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_QUANTITY_TRACE")?></td>		<td>			<table>				<col width="36"/>				<col />				<tr>					<td>						<input type="checkbox" name="XLS_QUANTITY_TRACE" <?if ($XLS_QUANTITY_TRACE == 1) echo ' checked '?> value="1">					</td>					<td>						<?=GetMessage("SOFTEFFECT_XLS_QUANTITY_TRACE_DESCR")?>					</td>				</tr>			</table>		</td>	</tr>	<tr>		<td colspan="2">			<div class="block-title">				<div class="block-title-inner"><?=GetMessage("SOFTEFFECT_XLS_BITRIX_PARAMS")?></div>			</div>		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_BITRIX_UNACTIVE")?></td>		<td>			<input type="checkbox" name="XLS_BITRIX_UNACTIVE" <?if ($XLS_BITRIX_UNACTIVE == 1) echo ' checked '?> value="1" />		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_BITRIX_COUNT_NULL")?></td>		<td>			<input type="checkbox" name="XLS_BITRIX_COUNT_NULL" <?if ($XLS_BITRIX_COUNT_NULL == 1) echo ' checked '?> value="1" />		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_BITRIX_PRICE_NULL")?></td>		<td>			<input type="checkbox" name="XLS_BITRIX_PRICE_NULL" <?if ($XLS_BITRIX_PRICE_NULL == 1) echo ' checked '?> value="1" />		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_IBLOCK_NAME_AUTO")?></td>		<td>			<input type="checkbox" name="XLS_IBLOCK_NAME_AUTO" <?if ($XLS_IBLOCK_NAME_AUTO == 1) echo ' checked '?> value="1" />		</td>	</tr>	<tr>		<td><?=GetMessage("SOFTEFFECT_XLS_NEW_ELEMENT_SKIP")?></td>		<td>			<input type="checkbox" name="XLS_NEW_ELEMENT_SKIP" <?if ($XLS_NEW_ELEMENT_SKIP == 1) echo ' checked '?> value="1" />		</td>	</tr><? } ?><? if ($USER->GetParam('SKIP_ALL_STEPS')=="Y") { ?>	</table>	<img src="/bitrix/templates/.default/ajax/images/wait.gif" class="skip-wait" />&nbsp;<?=GetMessage("SOFTEFFECT_XLS_STEP2_AUTOREDIRECT")?>	<script type="text/javascript">		document.getElementById('edit2_edit_table').style.display = 'none';		var d = document;		function document_loaded() {			setTimeout(function () {				document.getElementsByName('submit_btn')[0].click();				document.getElementsByName('submit_btn')[0].disabled = true;				document.getElementsByName('backButton')[0].disabled = true;				document.getElementsByName('backButton2')[0].disabled = true;			}, 500);		}		d.addEventListener("DOMContentLoaded", document_loaded, false);	</script>	<table><? } ?><script type="text/javascript">	window.onload = function() {        var inputs = document.getElementsByTagName('input');        for(var i = 0; i < inputs.length; i++) {        	if(document.getElementsByTagName("input")[i].type == "checkbox") {	            var input = inputs[i];	            input.onclick = function() {	            	if(this.checked == false) {		            	var el=document.createElement('input');	    				el.type='hidden';	    				el.id=this.id+"el";	    				el.name = this.name;	    				el.value="0";	    				par = document.getElementById("dataload");		            	par.insertBefore(el, par.firstChild);	            	} else{	            		var inputhidden = document.getElementById(this.id+"el");        				inputhidden.parentNode.removeChild(inputhidden);	            	}	            }           }        }    }</script>