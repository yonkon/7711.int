; /* /bitrix/js/sale/core_ui_widget.min.js?14339373825711*/
; /* /bitrix/js/sale/core_ui_etc.min.js?14339373825711*/
; /* /bitrix/js/sale/core_ui_autocomplete.min.js?143393738217811*/
; /* /bitrix/js/sale/core_ui_pager.min.js?14339373826727*/
; /* /bitrix/js/sale/core_ui_combobox.min.js?143393738217022*/
; /* /bitrix/js/sale/core_ui_chainedselectors.min.js?143393738210357*/

; /* Start:"a:4:{s:4:"full";s:52:"/bitrix/js/sale/core_ui_widget.min.js?14339373825711";s:6:"source";s:33:"/bitrix/js/sale/core_ui_widget.js";s:3:"min";s:37:"/bitrix/js/sale/core_ui_widget.min.js";s:3:"map";s:37:"/bitrix/js/sale/core_ui_widget.map.js";}"*/
(function(){if(typeof BX.ui!="object")BX.ui={};BX.ui.widget=function(t){BX.merge(this,{opts:{scope:false,useSpawn:false,messages:{},controls:{},bindEvents:{},removeTemplates:true,initializeByGlobalEvent:false,globalEventScope:"document"},vars:{},ctrls:{},tmpls:{},sys:{stack:{init:[]},code:"widget",initialized:false}});this.pushFuncStack("init",BX.ui.widget);this.isUIWidget=true};BX.merge(BX.ui.widget.prototype,{preInit:function(){var t=this,e=this.opts,i=this.ctrls,s=this.sys.code;i.scope=null;if(!("querySelector"in document))throw new Error("Your browser does not support querySelector");if(!s.match(/^[a-zA-Z0-9-_]+$/))throw new Error('Only letters, digitis, "-" and "_" allowed in code')},init:function(){var t=this,e=this.ctrls,i=this.opts,s=this.sys.code;if(i.scope!==false){e.scope=BX.type.isNotEmptyString(i.scope)?BX(i.scope):i.scope;if(!BX.type.isElementNode(e.scope))throw new Error("Invalid node passed");if(i.useSpawn&&e.scope)t.tmpls["scope"]=e.scope.outerHTML;var n=e.scope.querySelectorAll('script[type="text/html"]');for(var r=0;r<n.length;r++){var o=BX.data(n[r],"template-id");if(typeof o=="string"&&o.length>0&&o.search("bx-ui-"+s)==0){o=o.replace("bx-ui-"+s+"-","");t.tmpls[o]=n[r].innerHTML;if(this.opts.removeTemplates)BX.remove(n[r])}}}if(typeof i.bindEvents=="object"){for(var r in i.bindEvents){if(BX.type.isFunction(i.bindEvents[r]))this.bindEvent(r,i.bindEvents[r])}}i.bindEvents=null},remove:function(){if(BX.type.isDomNode(this.ctrls.scope))this.ctrls.scope.innerHTML="";BX.unbindAll(this)},getControlClassName:function(t){return"bx-ui-"+this.sys.code+"-"+t},getControl:function(t,e,i,s){if(!BX.type.isNotEmptyString(t))return null;if(BX.type.isElementNode(this.opts.controls[t]))return this.opts.controls[t];if(!this.ctrls.scope&&!searchWholeDoc)return null;var n=this.ctrls.scope;if(BX.type.isElementNode(i))n=i;var r=function(t){return!s&&t!==null||s&&t.length>0};try{var o=n[s?"querySelectorAll":"querySelector"]('[data-bx-ui-id="'+this.sys.code+"-"+t+'"]');if(r(o))return o}catch(l){}try{var o=n[s?"querySelectorAll":"querySelector"]("."+this.getControlClassName(t));if(r(o))return o}catch(l){}try{var o=n[s?"querySelectorAll":"querySelector"]("."+t);if(r(o))return o}catch(l){}try{var o=n[s?"querySelectorAll":"querySelector"](t);if(r(o))return o}catch(l){}if(o===null&&!e)throw new Error("Requested control node can not be found ("+t+")");return o},setOption:function(t,e){this.opts[t]=e},getOption:function(t){return this.opts[t]},getSysCode:function(){return this.sys.code},getHTMLByTemplate:function(t,e){var i=this.tmpls[t];if(!BX.type.isNotEmptyString(i))return"";for(var s in e){if(typeof e[s]!="undefined"&&e.hasOwnProperty(s)){var n="";if(s.toString().indexOf("=")==0){n=e[s].toString();s=s.toString().substr(1)}else n=BX.util.htmlspecialchars(e[s]).toString();var r="{{"+s.toString().toLowerCase()+"}}";if(n.search(r)>=0)n="";while(i.search(r)>=0)i=i.replace(r,n)}}return i},createNodesByTemplate:function(t,e,i){var s=this.tmpls[t];if(!BX.type.isNotEmptyString(s))return null;s=s.replace(/^\s\s*/,"").replace(/\s\s*$/,"");var n=this.getHTMLByTemplate(t,e);var r=false;var o=false;if(s.search(/^<\s*(tr|th)[^<]*>/)>=0)r=true;else if(s.search(/^<\s*td[^<]*>/)>=0)o=true;var l=document.createElement("div");if(r||o){if(r){l.innerHTML="<table><tbody>"+n+"</tbody></table>";l=l.childNodes[0].childNodes[0]}else{l.innerHTML="<table><tbody><tr>"+n+"</tr></tbody></table>";l=l.childNodes[0].childNodes[0].childNodes[0]}}else l.innerHTML=n;if(i){var c=l.childNodes;var a=[];for(var u=0;u<c.length;u++)if(BX.type.isElementNode(c[u]))a.push(c[u]);return a}else return Array.prototype.slice.call(l.childNodes)},replaceTemplate:function(t,e){this.tmpls[t]=e},parentConstruct:function(t,e){var i=t.superclass;if(typeof i=="object")i.constructor.apply(this,[e,true])},handleInitStack:function(t,e,i){this.pushFuncStack("init",e);if(!t){BX.merge(this.opts,i);BX.ui.widget.prototype.preInit.call(this);var s=function(){if(this.sys.initialized)return;this.resolveFuncStack("init");for(var t in this.sys.stack){if(t!="init")this.resolveFuncStack(t,true)}this.sys.initialized=true;this.fireEvent("init",[this])};if(BX.type.isString(this.opts.initializeByGlobalEvent)&&this.opts.initializeByGlobalEvent.length>0){var n=this.opts.globalEventScope=="window"?window:document;BX.addCustomEvent(n,this.opts.initializeByGlobalEvent,BX.proxy(s,this))}else s.call(this)}},pushFuncStack:function(t,e){if(BX.type.isFunction(e.prototype[t])){if(typeof this.sys.stack[t]=="undefined")this.sys.stack[t]=[];this.sys.stack[t].push({owner:e,f:e.prototype[t]})}},disableInFuncStack:function(t,e){var i=this.sys.stack[t];if(typeof i=="undefined")return;for(var s=0;s<i.length;s++){if(i[s].owner==e)i[s].f=BX.DoNothing}},resolveFuncStack:function(t,e){var i=this.sys.stack[t];if(typeof i=="undefined")return;for(var s=0;s<i.length;s++){i[s].f.call(this)}if(e)this.fireEvent(t,[this],document);this.sys.stack[t]=null},fireEvent:function(t,e,i){i=i||this;e=e||[];BX.onCustomEvent(i,"bx-ui-"+this.sys.code+"-"+t,e)},bindEvent:function(t,e){BX.addCustomEvent(this,"bx-ui-"+this.sys.code+"-"+t,e)},setCSSState:function(t,e){this.changeCSSState(t,e,true)},dropCSSState:function(t,e){this.changeCSSState(t,e,false)},changeCSSState:function(t,e,i){e=e||this.ctrls.scope;if(typeof t!="string"||t.length==0)return;BX[i?"addClass":"removeClass"](e,"bx-ui-state-"+t)},spawn:function(t,e){if(this.opts.useSpawn)BX.html(t,this.tmpls.scope);var i=BX.clone(this.opts);i.scope=t;if(BX.type.isFunction(e))e.apply(this,[i,t]);return new this.constructor(i)},getRandom:function(){return"bx"+this.sys.code+Math.floor(Math.random()*1e3+1)+Math.floor(Math.random()*1e3+1)}})})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:49:"/bitrix/js/sale/core_ui_etc.min.js?14339373825711";s:6:"source";s:30:"/bitrix/js/sale/core_ui_etc.js";s:3:"min";s:34:"/bitrix/js/sale/core_ui_etc.min.js";s:3:"map";s:34:"/bitrix/js/sale/core_ui_etc.map.js";}"*/
(function(){if(typeof BX.ui!="object")BX.ui={};BX.ui.loader=function(t,e){this.parentConstruct(BX.ui.loader,t);BX.merge(this,{opts:{timeout:100},sys:{code:"loader"}});this.handleInitStack(e,BX.ui.loader,t)};BX.extend(BX.ui.loader,BX.ui.widget);BX.merge(BX.ui.loader.prototype,{init:function(){},show:function(){var t=this;var e=this.vars;e.timer=setTimeout(function(){t.fireEvent("toggle",[true]);e.timer=null},this.opts.timeout)},hide:function(){clearTimeout(this.vars.timer);if(this.vars.timer==null)this.fireEvent("toggle",[false])}});BX.ui.scrollPaneNative=function(t,e){this.parentConstruct(BX.ui.scrollPaneNative,t);BX.merge(this,{opts:{eventTimeout:150,scrollError:30},vars:{prevScrollTop:0,atBottom:false},sys:{code:"scrollpanenative"}});this.handleInitStack(e,BX.ui.scrollPaneNative,t)};BX.extend(BX.ui.scrollPaneNative,BX.ui.widget);BX.merge(BX.ui.scrollPaneNative.prototype,{init:function(){this.ctrls.container=this.getControl("container");this.pushFuncStack("bindEvents",BX.ui.scrollPaneNative)},bindEvents:function(){var t=this,e=this.ctrls;BX.bind(e.container,"scroll",function(){t.checkScrollState()});BX.bind(e.container,"mousewheel",function(e){var i=BX.getWheelData(e);var n=false;var r=t.ctrls.container.scrollTop;var o=t.ctrls.container.scrollHeight;var s=t.ctrls.container.clientHeight;if(i>0&&r==0)n=true;if(i<0&&r>=o-s)n=true;if(n){BX.PreventDefault(e);BX.eventCancelBubble(e);return false}});BX.bind(window,"resize",function(){t.checkScrollState()});BX(function(){t.checkScrollState()})},informContentChanged:function(){this.vars.prevScrollTop=this.ctrls.container.scrollTop;this.vars.atBottom=false;this.checkScrollState()},dropScrollTop:function(){this.ctrls.container.scrollTop=0;this.checkScrollState()},scrollTo:function(t){var e=false;if(typeof t.y=="number")e=t.y;else if(typeof t.dy=="number")e=this.ctrls.container.scrollTop+t.dy;if(e!==false){this.ctrls.container.scrollTop=e}},checkFreeBottomSpace:function(){var t=this.ctrls;return t.container.scrollHeight<=t.container.clientHeight},checkScrolledToEnd:function(){var t=this.ctrls,e=this.vars,i=this.opts;var n=t.container.scrollTop;if(e.prevScrollTop==n)return;var r=t.container.scrollTop>=t.container.scrollHeight-t.container.clientHeight-i.scrollError;if(r==e.atBottom)return;e.atBottom=r;return e.atBottom},checkScrollState:function(){var t=this;if(!BX.type.isFunction(this.vars.checkFn)){this.vars.checkFn=BX.throttle(function(){if(t.checkFreeBottomSpace())t.fireEvent("has-free-space");if(t.checkScrolledToEnd())t.fireEvent("scroll-to-end")},t.opts.eventTimeout,t)}this.vars.checkFn()}});BX.ui.networkIOWidget=function(t,e){this.parentConstruct(BX.ui.networkIOWidget,t);BX.merge(this,{opts:{source:"/somewhere.php",pageSize:5,paginatedRequest:true},vars:{lastPage:0,loader:{show:BX.DoNothing,hide:BX.DoNothing}},ctrls:{},sys:{code:"network-io-widget"}});this.handleInitStack(e,BX.ui.networkIOWidget,t)};BX.extend(BX.ui.networkIOWidget,BX.ui.widget);BX.merge(BX.ui.networkIOWidget.prototype,{init:function(){},downloadBundle:function(t){var e=this.opts,i=this.vars,n=this.ctrls,r=this;i.loader.show(t.options);BX.ajax({url:e.source,method:"post",dataType:"json",async:true,processData:true,emulateOnload:true,start:true,data:BX.merge(r.refineRequest(t.request,t.options),r.getNavParams(t.options)),onsuccess:function(e){i.loader.hide(t.options);if(e.result){e.data=r.refineResponce(e.data,t.request,t.options);if(typeof e.data=="undefined")e.data=[];if(BX.type.isFunction(t.callbacks.onLoad))t.callbacks.onLoad.apply(r,[e.data])}else r.showError({errors:e.errors,type:"server-logic",options:t.options});if(BX.type.isFunction(t.callbacks.onComplete))t.callbacks.onComplete.call(r)},onfailure:function(e,n){i.loader.hide(t.options);r.showError({errors:[n.message],type:e,options:t.options,exception:n});if(BX.type.isFunction(t.callbacks.onComplete))t.callbacks.onComplete.call(r);if(BX.type.isFunction(t.callbacks.onError))t.callbacks.onError.apply(r,[e,n])}})},getNavParams:function(t){return this.opts.paginatedRequest?{PAGE_SIZE:this.opts.pageSize,PAGE:this.vars.lastPage}:{}},showError:function(t){BX.debug(t)},refineRequest:function(t,e){return t},refineResponce:function(t,e,i){return t}});BX.deferred=function(t){this.timer=null;this.actions={done:[],fail:[]};this.result=null;this.done=function(t){if(BX.type.isFunction(t))this.actions.done.push(t)};this.fail=function(t){if(BX.type.isFunction(t))this.actions.fail.push(t)};this.resolve=function(){if(this.result===false)return;this.result=true;this.callActions("done",arguments)};this.reject=function(){if(this.result===true)return;this.result=false;this.callActions("fail",arguments)};this.startRace=function(t,e){var i=this;this.timer=setTimeout(function(){e?i.resolve():i.reject()},t||300)};this.stopRace=function(){clearTimeout(this.timer)};this.callActions=function(t,e){for(var i in this.actions[t])this.actions[t][i].apply(this,e)};return this};BX.semaphore=function(t,e,i){var n=false;return function(){e=e||this;if(n)return;n=true;t.apply(e,arguments);n=false}};BX.util.wrapSubstring=function(t,e,i,n){if(t.length==0)return"";if(n){t=BX.util.htmlspecialchars(t);i=BX.util.htmlspecialchars(i)}if(e.length==0)return t;var r="";var o="";var s={};for(var a in e){o=e[a].toString().toLowerCase();r=t.toLowerCase();if(typeof s[o]!="undefined")continue;var c=r.indexOf(o);if(c>=0){var l=t.slice(0,c);var u=t.slice(c,c+o.length);var h=t.slice(c+o.length,t.length);t=l+"#A#"+u+"#B#"+h}s[o]=true}return t.replace(/#A#/g,"<"+i+">").replace(/#B#/g,"</"+i+">")};BX.util.getObjectLength=function(t){if(typeof t!="object")return 0;if("length"in t)return t.length;var e=0;for(var i in t){if(t.hasOwnProperty(i))e++}return e}})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:59:"/bitrix/js/sale/core_ui_autocomplete.min.js?143393738217811";s:6:"source";s:39:"/bitrix/js/sale/core_ui_autocomplete.js";s:3:"min";s:43:"/bitrix/js/sale/core_ui_autocomplete.min.js";s:3:"map";s:43:"/bitrix/js/sale/core_ui_autocomplete.map.js";}"*/
(function(){if(typeof BX.ui!="object")BX.ui={};BX.ui.autoComplete=function(e,t){this.parentConstruct(BX.ui.autoComplete,e);BX.merge(this,{opts:{source:"/somewhere.php",pageSize:20,paginatedRequest:true,autoSelectOnBlur:false,autoSelectOnTab:false,autoSelectOnlyIfOneVariant:false,selectOnEnter:true,selectByClick:true,chooseUsingArrows:true,scrollToVariantOnArrow:true,closePopupOnOuterClick:true,focusOnMouseSelect:true,autoSelectIfOneVariant:false,debounceTime:500,startSearchLen:2,knownItems:[],selectedItem:false,useCache:true,usePagingOnScroll:false,useCustomScrollPane:false,scrollThrottleTimeout:300,paneHConstraint:0,messages:{nothingFound:"Sorry, nothing found",error:"Error occured",clearSelection:"Clear selection"},arrowScrollAdditional:0,pageUpWardOffset:0,wrapTagName:"span",paneHConstraintType:"max-height",wrapSeparate:true,bindEvents:{init:function(){this.setInitialValue();this.vars.allowHideErrors=true}}},vars:{opened:false,eventLock:false,displayPageMutex:false,blockingCall:false,keyboardMutex:false,cache:{nodes:{},search:{},ceilings:{}},lastQuery:null,lastPage:0,displayedIndex:[],value:false,currentGlow:false,previousGlow:false,outSideClickScope:null,forceSelectSingeOnce:false,allowHideErrors:false},ctrls:{displayedItems:{}},sys:{code:"autocomplete"}});this.handleInitStack(t,BX.ui.autoComplete,e)};BX.extend(BX.ui.autoComplete,BX.ui.widget);BX.merge(BX.ui.autoComplete.prototype,{init:function(){var e=this,t=this.opts,n=this.vars,i=this.ctrls;var s=this.getControl("input",true);if(s==null)s=i.scope.querySelector('input[type="text"]');if(s==null)s=i.scope.querySelector("select");if(s==null)throw new Error("Input control still not found");i.inputs={origin:s==null?i.scope:s};n.loader=new BX.ui.loader({timeout:500});n.loader.bindEvent("toggle",BX.proxy(this.whenLoaderToggle,e));if(i.inputs.origin.nodeName=="SELECT"){throw new Error("Sorry, usage of <select> node as a source currently is not implemented")}if(typeof t.knownItems=="object")this.fillCache(t.knownItems,false);this.pushFuncStack("buildUpDOM",BX.ui.autoComplete);this.pushFuncStack("bindEvents",BX.ui.autoComplete)},buildUpDOM:function(){var e=this.opts,t=this.ctrls,n=this.vars,i=this.sys.code;t.container=BX.create("div",{props:{className:"bx-ui-"+i+"-container"},style:{margin:0,padding:0,border:"none",position:"relative"}});BX.insertAfter(t.container,t.inputs.origin);var s=BX.clone(t.inputs.origin);s.removeAttribute("name");BX.adjust(s,{props:{className:"bx-ui-"+i+"-fake"}});t.container.appendChild(s);t.inputs.fake=s;BX.hide(t.inputs.origin);if(BX.browser.IsIE8()){BX.bind(t.inputs.fake,"click",function(e){BX.eventCancelBubble(e)});BX.bind(t.container,"click",function(){t.inputs.fake.focus()})}t.clear=this.getControl("clear",true);if(!BX.type.isElementNode(t.clear)){t.clear=BX.create("div",{props:{className:"bx-ui-"+i+"-clear"},attrs:{title:e.messages.clearSelection},style:{position:"absolute",top:"0px",right:"0px"}});t.container.appendChild(t.clear)}BX.style(t.clear,"display","none");t.pane=this.getControl("pane",true);if(!BX.type.isElementNode(t.pane)){t.pane=BX.create("div",{props:{className:"bx-ui-"+i+"-pane"},style:{display:"none",position:"absolute"}});t.container.appendChild(t.pane)}if(e.usePagingOnScroll){BX.style(t.pane,"overflow-y","auto");BX.style(t.pane,"overflow-x","hidden");if(e.paneHConstraint>0&&e.paneHConstraintType!="")BX.style(t.pane,e.paneHConstraintType,e.paneHConstraint+"px")}t.vars=this.getControl("variants",true);if(!BX.type.isElementNode(t.vars)){t.vars=BX.create("div",{props:{className:"bx-ui-"+i+"-variants"}});t.pane.appendChild(t.vars)}t.nothingFound=this.getControl("nothing-found",true);t.errorMessage=this.getControl("error-message",true)},bindEvents:function(){var e=this,t=this.opts,n=this.vars,i=this.ctrls,s=this.sys.code;if(t.selectByClick){BX.bindDelegate(i.pane,"click",{className:"bx-ui-"+s+"-variant"},function(){var a=BX.data(this,"bx-"+s+"-item-value");if(typeof a!="undefined"&&typeof n.cache.nodes[a]!="undefined"){e.selectItem(a);if(t.focusOnMouseSelect)i.inputs.fake.focus()}})}BX.bindDebouncedChange(i.inputs.fake,function(n){if(n.length>=t.startSearchLen){e.displayPage({QUERY:n})}else e.hideDropdown()},function(){e.fireEvent("before-input-value-modify");e.deselectItem();e.fireEvent("after-input-value-modify")},t.debounceTime,i.inputs.fake);BX.addCustomEvent(document,"bx-ui-"+s+"-close-dropdown",function(){e.hideDropdown()});if(t.closePopupOnOuterClick){n.outSideClickScope=i.container;BX.bind(document,"click",function(t){t=t||window.event;if(!BX.isParentForNode(n.outSideClickScope,t.target||t.srcElement)){e.hideDropdown()}})}BX.bind(i.inputs.fake,"keydown",function(s){if(n.keyboardMutex){return}var a=s.keyCode||s.which;var r=n.displayedIndex.length;if(t.chooseUsingArrows){if((a==38||a==40)&&n.opened&&r>0){var o=a==38?-1:1;if(n.currentGlow==r-1&&e.getCanLoadMore()){return}n.previousGlow=n.currentGlow;n.currentGlow+=o;n.currentGlow=n.currentGlow%r;if(n.currentGlow<0)n.currentGlow=r+n.currentGlow;e.toggleGlow();var l=i.displayedItems[n.displayedIndex[n.currentGlow]];if(t.scrollToVariantOnArrow){var c=BX.pos(l,i.vars);var u=c.top+c.height;var d=c.top;var h=c.height;var f=i.pane.clientHeight;var p=i.pane.scrollTop;var g=t.arrowScrollAdditional;if(d+h>f+p){i.scrollController.scrollTo({dy:d+h-(f+p)+g})}else if(d<p){i.scrollController.scrollTo({dy:-(p-d+g)})}}BX.PreventDefault(s)}}if(a==13&&t.selectOnEnter){if(n.currentGlow!==false)e.selectItem(n.displayedIndex[n.currentGlow]);else if(n.opened&&r>0)e.selectItem(n.displayedIndex[0])}if(a==9&&n.opened&&t.autoSelectOnTab){if(t.autoSelectOnlyIfOneVariant&&r==1||!t.autoSelectOnlyIfOneVariant&&r>0)e.selectItem(n.displayedIndex[0]);else e.hideDropdown()}if(a==13)BX.PreventDefault(s)});if(t.autoSelectOnBlur){BX.bind(i.inputs.fake,"blur",function(){var i=n.displayedIndex.length;if(n.opened&&(t.autoSelectOnlyIfOneVariant&&i==1||!t.autoSelectOnlyIfOneVariant&&i>0))e.selectItem(n.displayedIndex[0])})}if(t.autoSelectOnBlur){BX.bind(i.inputs.fake,"blur",function(){var i=n.displayedIndex.length;if(n.opened&&(t.autoSelectOnlyIfOneVariant&&i==1||!t.autoSelectOnlyIfOneVariant&&i>0))e.selectItem(n.displayedIndex[0])})}BX.bind(i.inputs.fake,"click",function(){if(!n.opened&&n.value===false&&n.displayedIndex.length>0)e.showDropdown()});BX.bind(i.clear,"click",function(){e.clearSelected()});if(t.usePagingOnScroll){if(t.useCustomScrollPane){i.scrollController=null;throw new Error("Sorry, custom scroll panel currently is not implemented")}else{i.scrollController=new BX.ui.scrollPaneNative({scope:i.pane,eventTimeout:t.scrollThrottleTimeout,controls:{container:i.pane}})}e.vars.addPage=BX.debounce(function(){if(!n.opened)return;e.blockingCall();e.displayNextPage()},10);i.scrollController.bindEvent("scroll-to-end",e.vars.addPage);i.scrollController.bindEvent("has-free-space",e.vars.addPage);this.bindEvent("after-page-display",function(){i.scrollController.informContentChanged();if(e.vars.lastPage==0)i.scrollController.dropScrollTop()})}BX.bind(i.inputs.origin,"change",function(){if(n.eventLock)return;if(this.value==""){if(n.value)e.clearSelected()}else{e.setValue(this.value)}})},addItems2Cache:function(){},clearCache:function(){},focus:function(){this.ctrls.inputs.fake.focus()},checkDisabled:function(){},disable:function(){},enable:function(){},setValue:function(e,t){var n=this.vars,i=this.opts,s=this.ctrls,a=this;this.hideError();if(e==null||e==false||typeof e=="undefined"||e.toString().length==0){this.resetVariables();BX.cleanNode(s.vars);if(BX.type.isElementNode(s.nothingFound))BX.hide(s.nothingFound);this.fireEvent("after-deselect-item");this.fireEvent("after-clear-selection");return}else if(e==n.value)return;if(t!==false)n.forceSelectSingeOnce=true;if(typeof n.cache.nodes[e]=="undefined"){this.resetNavVariables();a.downloadBundle({VALUE:e},function(t){a.fillCache(t,false);if(typeof n.cache.nodes[e]=="undefined"){a.showNothingFound()}else{if(i.autoSelectIfOneVariant||n.forceSelectSingeOnce)a.selectItem(e);else a.displayVariants([e])}},function(){n.forceSelectSingeOnce=false})}else{if(n.forceSelectSingeOnce)this.selectItem(e);else this.displayVariants([e]);n.forceSelectSingeOnce=false}},getValue:function(){return this.vars.value===false?"":this.vars.value},clearSelected:function(){this.setValue("")},getNodeByValue:function(e){return this.vars.cache.nodes[e]},setTabIndex:function(e){this.ctrls.inputs.fake.setAttribute("tabindex",e)},setTargetInputName:function(e){this.ctrls.inputs.origin.setAttribute("name",e)},cancelRequest:function(){this.vars.forceSelectSingeOnce=false},setTargetInputValue:function(e){this.vars.eventLock=true;this.ctrls.inputs.origin.value=this.getSelectorValue(e);BX.fireEvent(this.ctrls.inputs.origin,"change");this.vars.eventLock=false},setFakeInputValue:function(e){var t=this.ctrls;BX.data(t.inputs.fake,"bx-dc-previous-value",e);t.inputs.fake.value=e},setValueVariable:function(e){this.vars.value=e},fillCache:function(e,t){var n=this.vars,i=this.opts;if(!e.length)return;for(var s in e)this.addItem2Cache(e[s]);if(typeof t=="number"&&t!=0){if(typeof n.cache.search[t]=="undefined")n.cache.search[t]=[];for(var s in e)n.cache.search[t].push(e[s].VALUE)}},addItem2Cache:function(e){this.vars.cache.nodes[e.VALUE]=e},setInitialValue:function(){var e=false;if(this.opts.selectedItem!==false)e=this.opts.selectedItem;else if(this.ctrls.inputs.origin.value.length>0)e=this.ctrls.inputs.origin.value;if(e!==false)this.setValue(e)},getCachedPage:function(e,t){var n=this.opts,i=this.vars;var s=this.getCacheKeyForQuery(e);if(typeof i.cache.search[s]!="object"||!("length"in i.cache.search[s]))return false;var a=i.cache.search[s].slice(t*n.pageSize,(t+1)*n.pageSize);if(a.length==0)return false;return a},displayNextPage:function(){var e=this.vars;if(!this.opts.usePagingOnScroll||e.lastQuery==null)return;this.displayPage(e.lastQuery,e.lastPage+1)},displayPage:function(e,t){var n=this.opts,i=this.vars,s=this.ctrls,a=this;if(i.blockingCall&&i.displayPageMutex)return;e=this.refineQuery(e);var r=this.getCacheKeyForQuery(e);if(typeof t=="undefined")t=0;var o=this.manageCeiling(r);if(o>0&&o<=t)return;i.keyboardMutex=true;i.displayPageMutex=true;i.blockingCall=false;i.lastQuery=e;i.lastPage=t;if(n.useCache){var l=this.getCachedPage(e,t);if(l!==false){if((n.autoSelectIfOneVariant||i.forceSelectSingeOnce)&&l.length==1&&i.lastPage==0)a.selectItem(l[0]);else a.displayVariants(l,t);i.forceSelectSingeOnce=false;i.displayPageMutex=false;i.keyboardMutex=false}else{a.downloadBundle(e,function(s){a.fillCache(s,r);l=this.getCachedPage(e,t);if(l==false){if(t==0)a.showNothingFound();else{a.manageCeiling(r,t)}}else{if((n.autoSelectIfOneVariant||i.forceSelectSingeOnce)&&l.length==1&&i.lastPage==0)a.selectItem(l[0]);else a.displayVariants(l,t);if(!n.paginatedRequest)a.manageCeiling(r,Math.ceil(i.cache.search[r].length/n.pageSize))}},function(){i.forceSelectSingeOnce=false;i.blockingCall=false;i.displayPageMutex=false;i.keyboardMutex=false})}}else throw new Error("Sorry, useCache = false currently is not implemented")},manageCeiling:function(e,t){var n=this.vars;if(typeof t=="undefined"){if(typeof n.cache.ceilings[e]=="undefined")return-1;return n.cache.ceilings[e]}n.cache.ceilings[e]=t},getCanLoadMore:function(e){var t=this.vars;if(typeof e=="undefined")e=this.getCacheKeyForQuery(t.lastQuery);if(typeof t.cache.ceilings[e]=="undefined")return true;return t.lastPage<t.cache.ceilings[e]},resetVariables:function(){this.deselectItem();this.setFakeInputValue("");this.resetNavVariables()},resetNavVariables:function(){this.vars.lastQuery=null;this.vars.lastPage=0},setTargetValue:function(e){var t=this.opts,n=this.vars,i=this.vars.value!==false;n.value=e==""?false:e;this.setTargetInputValue(e);if(n.value)this.fireEvent("after-select-item",[n.value,true]);else if(i)this.fireEvent("after-deselect-item")},blockingCall:function(){this.vars.blockingCall=true},downloadBundle:function(e,t,n,i){var s=this.opts,a=this.vars,r=this.ctrls,o=this;a.loader.show();BX.ajax({url:o.opts.source,method:"post",dataType:"json",async:true,processData:true,emulateOnload:true,start:true,data:BX.merge(o.refineRequest(e),o.getNavParams()),onsuccess:function(i){a.loader.hide();if(i.result){i.data=o.refineResponce(i.data,e);if(typeof i.data=="undefined")i.data=[];t.apply(o,[i.data])}else o.showError(o.opts.messages.error,i.errors);n.call(o)},onfailure:function(e){a.loader.hide();o.showError(s.messages.error,false,e);n.call(o);if(BX.type.isFunction(i))i.call(o)}})},getNavParams:function(){return this.opts.paginatedRequest?{PAGE_SIZE:this.opts.pageSize,PAGE:this.vars.lastPage}:{}},getSelectorValue:function(e){return e},getCacheKeyForQuery:function(e){var t="";for(var n in e){if(e.hasOwnProperty(n)){t+=n.toString().toLowerCase()+":"+e[n].toString().toLowerCase()+"|"}}return BX.util.hashCode(t)},refineQuery:function(e){return e},refineRequest:function(e){return e},refineResponce:function(e,t){return e},deselectItem:function(){var e=this.vars,t=this.ctrls,n=this.opts;this.hideError();this.whenClearToggle.apply(this,[false]);e.currentGlow=false;e.previousGlow=false;e.displayedIndex=[];t.displayedItems={};this.setTargetValue("")},selectItem:function(e){var t=this.vars,n=this.ctrls,i=this.opts;t.value=e;n.inputs.origin.value=t.cache.nodes[e].VALUE;this.setFakeInputValue(this.whenItemSelect.apply(this,[e]));this.hideDropdown();this.whenClearToggle.apply(this,[true]);this.setTargetValue(e)},toggleGlow:function(){var e=this.opts,t=this.ctrls,n=this.vars;var i=t.displayedItems[n.displayedIndex[n.currentGlow]];if(n.previousGlow!==false)this.whenItemToggle(false,t.displayedItems[n.displayedIndex[n.previousGlow]],n.previousGlow);if(n.currentGlow!==false)this.whenItemToggle(true,i,n.currentGlow)},showDropdown:function(){if(this.vars.opened)return;var e=!this.vars.opened;this.vars.opened=true;if(this.vars.lastPage==0){this.vars.currentGlow=0;this.toggleGlow()}BX.show(this.ctrls.pane);var t=BX.height(this.ctrls.pane);BX.hide(this.ctrls.pane);var n=this.ctrls.inputs.fake;var i=BX.pos(n);var s=BX.scrollTop(window)+BX.height(window)-(Math.ceil(i.top)+i.height);this.whenDropdownToggle.apply(this,[true,s-t<-20,i.height,e])},hideDropdown:function(){this.vars.opened=false;this.whenDropdownToggle.apply(this,[false,false,0,true])},clearDisplayedVariants:function(){this.hideDropdown();this.vars.displayedIndex=[]},displayVariants:function(e,t){var n=this.ctrls,i=this.vars,s=this.opts,a=this.sys.code;this.hideNothingFound();if(typeof t=="undefined"||t==0){BX.cleanNode(n.vars);i.displayedIndex=[];n.displayedItems={}}var r=i.displayedIndex.length;for(var o in e){var l=this.whenRenderVariant(e[o],r+parseInt(o))[0];BX.data(l,"bx-"+a+"-item-value",e[o]);n.vars.appendChild(l);this.fireEvent("after-item-append",[l]);i.displayedIndex.push(e[o]);n.displayedItems[e[o]]=l}this.showDropdown();this.fireEvent("after-page-display",[i.cache.nodes,t])},showNothingFound:function(){BX.cleanNode(this.ctrls.vars);if(BX.type.isElementNode(this.ctrls.nothingFound))this.whenNothingFoundToggle(true);else{this.ctrls.vars.appendChild(this.whenRenderNothingFound(this.opts.messages.nothingFound));this.showDropdown()}this.fireEvent("nothing-found")},hideNothingFound:function(){if(BX.type.isElementNode(this.ctrls.nothingFound))this.whenNothingFoundToggle(false)},hideError:function(){if(BX.type.isElementNode(this.ctrls.errorMessage)&&this.vars.allowHideErrors)BX.hide(this.ctrls.errorMessage)},showError:function(e,t,n){BX.cleanNode(this.ctrls.vars);this.ctrls.vars.appendChild(this.whenRenderError(e));this.showDropdown();BX.debug(arguments)},refineItemDataForTemplate:function(e){var t=this.vars.lastQuery.QUERY;if(BX.type.isNotEmptyString(t)){var n=[];if(this.opts.wrapSeparate)n=t.split(/\s+/);else n=[t];e["=display_wrapped"]=BX.util.wrapSubstring(e.DISPLAY,n,this.opts.wrapTagName,true)}else e["=display_wrapped"]=BX.util.htmlspecialchars(e.DISPLAY);return e},getCurrentItem:function(){return this.vars.cache.nodes[this.vars.value]},whenDisplayVariant:function(e){return this.vars.cache.nodes[e]["DISPLAY"]},whenItemSelect:function(e){return this.vars.cache.nodes[e]["DISPLAY"]},whenLoaderToggle:function(e){BX[e?"addClass":"removeClass"](this.ctrls.inputs.fake,"bx-ui-"+this.sys.code+"-loading")},whenDropdownToggle:function(e,t,n,i){if(e){if(i)this.whenDecidePaneOrient(t,n,i);BX.show(this.ctrls.pane)}else BX.hide(this.ctrls.pane);this.fireEvent("after-popup-toggled",[e])},whenDecidePaneOrient:function(e,t){var n=this.ctrls;if(e){var i=BX.style(n.pane,"top");if(i!="auto"){BX.data(n.pane,"pane-top",i)}BX.style(n.pane,"top","auto");BX.style(n.pane,"bottom",t+this.opts.pageUpWardOffset+"px")}else{var i=BX.data(n.pane,"pane-top");if(typeof i!="undefined")BX.style(n.pane,"top",i);BX.style(n.pane,"bottom","auto")}},whenItemToggle:function(e,t,n){BX[e?"addClass":"removeClass"](t,"bx-ui-"+this.sys.code+"-variant-active")},whenClearToggle:function(e){BX[e?"show":"hide"](this.ctrls.clear)},whenNothingFoundToggle:function(e){BX[e?"show":"hide"](this.ctrls.nothingFound)},whenRenderVariant:function(e,t){var n=BX.clone(this.vars.cache.nodes[e]);n=this.refineItemDataForTemplate(n);n.index=t;this.fireEvent("before-render-variant",[n]);if(typeof this.tmpls["dropdown-item"]=="string")return this.createNodesByTemplate("dropdown-item",n,true);return[BX.create("div",{props:{className:"bx-ui-"+this.sys.code+"-variant"},text:this.vars.cache.nodes[e]["DISPLAY"]})]},whenRenderError:function(e){if(typeof this.tmpls["error"]=="string")return this.createNodesByTemplate("error",{message:e},true)[0];return BX.create("div",{props:{className:"bx-ui-"+this.sys.code+"-error"},text:e})},whenRenderNothingFound:function(e){if(typeof this.tmpls["nothing-found"]=="string")return this.createNodesByTemplate("nothing-found",{message:e},true)[0];return this.whenRenderError(e)}})})();
/* End */
;
; /* Start:"a:4:{s:4:"full";s:51:"/bitrix/js/sale/core_ui_pager.min.js?14339373826727";s:6:"source";s:32:"/bitrix/js/sale/core_ui_pager.js";s:3:"min";s:36:"/bitrix/js/sale/core_ui_pager.min.js";s:3:"map";s:36:"/bitrix/js/sale/core_ui_pager.map.js";}"*/
BX.ui.scrollablePager=function(e,t){this.parentConstruct(BX.ui.scrollablePager,e);BX.merge(this,{opts:{areaHeight:100,eventTimeout:100,pageRenderer:false,setTopReachedOnPage:false,setBottomReachedOnPage:false},vars:{pages:0,boundsReached:{top:false,bottom:false},prevScrollTop:false,scrollEventLock:false,pageRange:false,renderer:false},sys:{code:"pager"}});this.handleInitStack(t,BX.ui.scrollablePager,e)};BX.extend(BX.ui.scrollablePager,BX.ui.widget);BX.merge(BX.ui.scrollablePager.prototype,{init:function(){this.ctrls.pane=this.getControl("pane");this.vars.scrollEventDispatcher=BX.throttle(this.checkScrollState,this.opts.eventTimeout,this);if(this.opts.pageRenderer!==false)this.vars.renderer=this.opts.pageRenderer;else this.vars.renderer=new BX.ui.scrollablePager.renderers.native;this.vars.renderer.init({scope:this.ctrls.scope,pane:this.ctrls.pane,parent:this});this.pushFuncStack("buildUpDOM",BX.ui.scrollablePager);this.pushFuncStack("bindEvents",BX.ui.scrollablePager)},buildUpDOM:function(){var e=this.ctrls;var t=this.createNodesByTemplate("pager-area",{},true);if(t==null||!BX.type.isDomNode(t[0]))t=BX.create("div",{style:{height:parseInt(this.opts.areaHeight)+"px"}});else t=t[0];e.areas={top:{node:t,height:0},bottom:{node:BX.clone(t),height:0}};e.pool=BX.create("div");BX.append(e.areas.top.node,e.pane);BX.append(e.pool,e.pane);BX.append(e.areas.bottom.node,e.pane);this.vars.renderer.update()},bindEvents:function(){BX.addCustomEvent(this.vars.renderer,"bx-ui-pagerenderer-scroll-changed",BX.proxy(function(){this.dispatchScrollEvents()},this));this.vars.renderer.bindScrollEvents()},scrollTo:function(e,t,s){var r=this.vars;if(t)r.scrollEventLock=true;r.renderer.setScrollTop(e,s);if(t)r.scrollEventLock=false;return true},scrollToNode:function(e){},dispatchScrollEvents:function(){if(this.vars.scrollEventLock)return false;this.vars.scrollEventDispatcher()},lockScrollEvents:function(){this.vars.scrollEventLock=true},unLockScrollEvents:function(){this.vars.scrollEventLock=false},prependPage:function(e){this.addPage(e,this.vars.pageRange==false?0:this.vars.pageRange[0]-1)},appendPage:function(e){this.addPage(e,this.vars.pageRange==false?0:this.vars.pageRange[1]+1)},getFreePageNumber:function(e){if(this.vars.pageRange==false)return 0;if(e==0)return this.vars.pageRange[0]-1;if(e==1)return this.vars.pageRange[1]+1;return false},getPageCount:function(){return this.vars.pages},setTopReached:function(e){if(typeof e=="undefined")e=true;this.manageBounds(e,true)},setBottomReached:function(e){if(typeof e=="undefined")e=true;this.manageBounds(e,false)},cleanUp:function(){this.ctrls.pool.innerHTML="";this.setTopReached(false);this.setBottomReached(false);this.vars.pages=0;this.vars.pageRange=false;this.vars.renderer.update()},remove:function(){if(BX.type.isDomNode(this.ctrls.scope))this.ctrls.scope.innerHTML="";BX.unbindAll(this);this.vars.renderer.remove()},addPage:function(e,t){var s=this.vars,r=this.opts,o=this.getPageWrapper();var n=this.ctrls.scope.scrollTop;if(s.pageRange!=false){if(t!=s.pageRange[1]+1&&t!=s.pageRange[0]-1)throw new Error("Not allowed to break page range integrity")}if(r.setTopReachedOnPage!==false&&t==r.setTopReachedOnPage)this.setTopReached();if(r.setBottomReachedOnPage!==false&&t==r.setBottomReachedOnPage)this.setBottomReached();var i=s.pageRange==false||t>s.pageRange[1];if(BX.type.isString(e))o.innerHTML=e;else if(BX.type.isDomNode(e))BX.append(e,o);else if("length"in e&&e.length>0){for(var a in e){if(BX.type.isDomNode(e[a]))BX.append(e[a],o)}}else return false;var l=this.vars.renderer.getScrollTop();BX[i?"append":"prepend"](o,this.ctrls.pool);if(!s.boundsReached.top&&s.pages==0){this.scrollTo(this.ctrls.areas.top.node.offsetHeight,true)}else{if(i){this.scrollTo(l,true)}else this.scrollTo(o.offsetHeight,true,+1)}this.vars.renderer.update();if(s.pageRange==false){s.pageRange=[t,t]}else{if(i)s.pageRange[1]++;else s.pageRange[0]--}s.pages++;this.dispatchScrollEvents()},checkScrollState:function(){var e=this.vars;var t=e.renderer.getScrollTop();if(t!=0&&e.prevScrollTop==t)return false;if(this.checkScrolledToTop(t)&&!e.boundsReached.top)this.fireEvent("scroll-to-top");if(this.checkScrolledToBottom(t)&&!e.boundsReached.bottom)this.fireEvent("scroll-to-bottom");e.prevScrollTop=t},getPageWrapper:function(){return BX.create("div",{props:{className:"bx-ui-"+this.sys.code+"-page-wrapper"}})},topOn:function(){this.manageBounds(false,true)},topOff:function(){this.manageBounds(true,true)},manageBounds:function(e,t){e=!!e;t=!!t;var s=this.vars,r=this.ctrls;if(t){var o=this.vars.renderer.getScrollTop();var n=!s.boundsReached.top&&e||s.boundsReached.top&&!e;if(n){var i=BX.style(r.areas.top.node,"display")=="none";var a=0;if(i){BX.show(r.areas.top.node);a=r.areas.top.node.offsetHeight}else{a=r.areas.top.node.offsetHeight;BX.hide(r.areas.top.node)}this.scrollTo(a,true,e?-1:+1)}}else BX[e?"hide":"show"](this.ctrls.areas.bottom.node);this.vars.boundsReached[t?"top":"bottom"]=e;this.vars.renderer.update()},checkFreeBottomSpace:function(){return this.vars.renderer.getScrollTop()<=this.vars.renderer.getClientHeight()},checkScrolledToTop:function(e){return e<=this.ctrls.areas.top.node.offsetHeight},checkScrolledToBottom:function(e){var t=this.ctrls;return e>=this.vars.renderer.getScrollHeight()-this.vars.renderer.getClientHeight()-t.areas.bottom.node.offsetHeight}});BX.ui.scrollablePager.renderers={"native":function(){this.opts={};this.wheelLock=false;this.init=function(e){this.opts=e};this.remove=function(){BX.unbind(this.opts.scope,"scroll",this.fireEvent);BX.unbind(this.opts.scope,"mousewheel",this.fireEvent);BX.unbind(this.opts.pane,"touchstart",this.fireEvent);BX.unbind(window,"resize",this.fireEvent);this.opts=null};this.update=function(){};this.setScrollTop=function(e,t){if(typeof e=="undefined")return false;e=parseInt(e);if(e.toString()=="NaN")return false;if(t!=1&&t!=-1)this.opts.scope.scrollTop=e;else this.opts.scope.scrollTop+=t*e};this.getScrollTop=function(){return this.opts.scope.scrollTop};this.getScrollHeight=function(){return this.opts.scope.scrollHeight};this.getClientHeight=function(){return this.opts.scope.clientHeight};this.bindScrollEvents=function(){var e=this;BX.bind(this.opts.scope,"mousewheel",function(t){var s=BX.getWheelData(t);var r=false;if(s>0&&e.getScrollTop()==0)r=true;if(s<0&&e.getScrollTop()>=e.getScrollHeight()-e.getClientHeight())r=true;if(r){BX.PreventDefault(t);BX.eventCancelBubble(t);return false}});this.fireEvent=function(t){BX.onCustomEvent(e,"bx-ui-pagerenderer-scroll-changed",[])};BX.bind(this.opts.scope,"scroll",this.fireEvent);BX.bind(this.opts.pane,"touchstart",this.fireEvent);BX.bind(window,"resize",this.fireEvent)};return this}};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:55:"/bitrix/js/sale/core_ui_combobox.min.js?143393738217022";s:6:"source";s:35:"/bitrix/js/sale/core_ui_combobox.js";s:3:"min";s:39:"/bitrix/js/sale/core_ui_combobox.min.js";s:3:"map";s:39:"/bitrix/js/sale/core_ui_combobox.map.js";}"*/
if(typeof BX.ui!="object")BX.ui={};BX.ui.combobox=function(e,t){this.parentConstruct(BX.ui.combobox,e);BX.merge(this,{opts:{pageSize:5,selectedItem:false,knownItems:[],selectByClick:true,chooseUsingArrows:true,selectOnEnter:true,openDdByAltArrow:true,closeDdByEscape:true,scrollToVariantOnArrow:true,closePopupOnOuterClick:true,messages:{nothingFound:"Sorry, nothing found",notSelected:"-- Not selected",error:"Error occured",clearSelection:"Deselect"},arrowScrollAdditional:0,pageUpWardOffset:0,wrapTagName:"span",dropdownHConstraint:0,dropdownHConstraintType:"max-height",inputDebounceTimeout:500,scrollThrottleTimeout:300,selectByClickTimeout:200,startSearchLen:2,bindEvents:{init:function(){this.setInitialValue()}}},vars:{opened:false,eventLock:false,displayPageMutex:false,keyboardMutex:false,allEventMutex:false,cache:{nodes:{},search:{origin:false}},applyFilter:false,filtered:[],lastSource:false,pager:false,selector:false,value:false,outSideClickScope:null},ctrls:{},sys:{code:"combobox"}});this.handleInitStack(t,BX.ui.combobox,e)};BX.extend(BX.ui.combobox,BX.ui.widget);BX.merge(BX.ui.combobox.prototype,{init:function(){var e=this,t=this.opts,i=this.vars,s=this.ctrls;var n=this.getControl("input",true);if(n==null)n=s.scope.querySelector('input[type="text"]');if(n==null)n=s.scope.querySelector("select");if(n==null)throw new Error("Input control still not found");s.inputs={origin:n==null?s.scope:n};i.loader=new BX.ui.loader({timeout:500});i.loader.bindEvent("toggle",BX.proxy(this.whenLoaderToggle,e));if(typeof t.knownItems=="object")this.fillCache(t.knownItems,false);this.pushFuncStack("buildUpDOM",BX.ui.combobox);this.pushFuncStack("bindEvents",BX.ui.combobox)},buildUpDOM:function(){var e=this.opts,t=this.ctrls,i=this.vars,s=this,n=this.sys.code;t.container=this.getControl("container",true);if(!BX.type.isElementNode(t.container)){t.container=BX.create("div",{props:{className:"bx-ui-"+n+"-container"},style:{margin:0,padding:0,border:"none",position:"relative"}});BX.insertAfter(t.container,t.inputs.origin)}t.inputs.fake=this.getControl("fake",true);if(!BX.type.isElementNode(t.container)){var r=BX.clone(t.inputs.origin);r.removeAttribute("name");BX.adjust(r,{props:{className:"bx-ui-"+n+"-fake"}});t.container.appendChild(r);t.inputs.fake=r}BX.hide(t.inputs.origin);if(BX.browser.IsIE8()){BX.bind(t.inputs.fake,"click",function(e){BX.eventCancelBubble(e)});BX.bind(t.container,"click",function(){t.inputs.fake.focus()})}t.toggle=this.getControl("toggle",true);if(!BX.type.isElementNode(t.toggle)){t.toggle=BX.create("div",{props:{className:"bx-ui-"+n+"-toggle"},style:{position:"absolute",top:"0px",right:"0px"}});t.container.appendChild(t.toggle)}t.dropdown=this.getControl("dropdown",true);if(!BX.type.isElementNode(t.dropdown)){t.dropdown=BX.create("div",{props:{className:"bx-ui-"+n+"-dropdown"},style:{display:"none",position:"absolute"}});t.container.appendChild(t.dropdown)}if(e.dropdownHConstraint>0&&e.dropdownHConstraintType!="")BX.style(t.dropdown,e.dropdownHConstraintType,e.dropdownHConstraint+"px");i.pager=new BX.ui.scrollablePager({scope:t.dropdown,setTopReachedOnPage:0,eventTimeout:e.scrollThrottleTimeout,parent:s});i.selector=new BX.ui.itemSelectManager;t.nothingFound=this.getControl("nothing-found",true)},bindEvents:function(){var e=this.ctrls,t=this.opts,i=this.vars,s=this,n=this.sys.code;this.bindEventsMouse();this.bindEventsKeyboard();i.pager.bindEvent("scroll-to-top",BX.semaphore(function(){if(!this.vars.opened)return;var e=i.pager.getFreePageNumber(0);if(this.checkPageIsOutOfRange(e))return;s.displayPage(e)},this,{limit:1,dup:"drop"}));i.pager.bindEvent("scroll-to-bottom",BX.semaphore(function(){if(!this.vars.opened)return;var e=i.pager.getFreePageNumber(1);if(this.checkPageIsOutOfRange(e))return;s.displayPage(e)},this,{limit:1,dup:"drop"}));i.selector.bindEvent("item-select",function(e,t){s.whenToggleItemGlow(t,true)});i.selector.bindEvent("item-deselect",function(e,t){s.whenToggleItemGlow(t,false)})},bindEventsMouse:function(){var e=this.ctrls,t=this.opts,i=this.vars,s=this,n=this.sys.code;if(t.selectByClick){BX.bindDelegate(e.dropdown,"click",{className:"bx-ui-"+n+"-variant"},function(){if(i.allEventMutex)return;var r=BX.data(this,"bx-"+n+"-item-value");var a=this;if(r==s.vars.value){s.hideDropdown();return}if(typeof r!="undefined"&&typeof i.cache.nodes[r]!="undefined"){s.vars.selector.selectById(r);s.setValue(r);if(t.focusOnMouseSelect)e.inputs.fake.focus();s.fireEvent("item-selected-by-mouse",[r,a])}else s.setValue("")})}if(t.closePopupOnOuterClick){if(i.allEventMutex)return;i.outSideClickScope=e.container;BX.bind(document,"click",function(e){e=e||window.event;if(!BX.isParentForNode(i.outSideClickScope,e.target||e.srcElement)){s.hideDropdown()}})}BX.bind(e.toggle,"click",function(){s.toggleDropDown()});if("value"in e.inputs.fake){BX.bind(e.inputs.fake,"click",function(){if(!i.opened&&i.value===false&&this.value.length>0)s.tryDisplayPage("search")})}},bindEventsKeyboard:function(){var e=this.ctrls,t=this.opts,i=this.vars,s=this;if("value"in e.inputs.fake){BX.bindDebouncedChange(e.inputs.fake,function(e){if(i.allEventMutex)return;if(e.length>=t.startSearchLen){s.tryDisplayPage("search")}else s.hideDropdown()},function(){if(i.allEventMutex)return;if(i.value!=false&&i.value!="")s.deselectItem()},t.inputDebounceTimeout,e.inputs.fake);BX.bind(e.inputs.fake,"keydown",function(n){if(i.allEventMutex)return;if(i.keyboardMutex)return;var r=n.keyCode||n.which;var a=r==38||r==40;if(t.chooseUsingArrows){if(a&&i.opened){i.selector[r==38?"selectPrevious":"selectNext"](n.shiftKey?5:1);if(t.scrollToVariantOnArrow){var o=i.selector.getSelected();if(typeof o!="undefined"){var l=o.data.node;var c=BX.pos(l,e.dropdown);var h=c.top;var u=c.height;var d=e.dropdown.clientHeight;var f=e.dropdown.scrollTop;var p=t.arrowScrollAdditional;var g=false;if(h+u>d+f)g=h+u-(d+f)+p;else if(h<f)g=-(f-h+p);if(g!=false)i.pager.scrollTo(g,false,1)}}BX.PreventDefault(n)}}if(t.openDdByAltArrow&&n.altKey&&a&&!i.opened)s.tryDisplayPage("toggle");if(t.closeDdByEscape&&r==27&&i.opened)s.hideDropdown();if(r==13&&t.selectOnEnter&&i.opened){var v=i.selector.getSelected();if(typeof v!="undefined"){if(v.id==s.vars.value){s.hideDropdown();return}s.setValue(v.id)}}if(r==13)BX.PreventDefault(n)})}},addItems2Cache:function(e){this.fillCache(e)},clearCache:function(){this.vars.cache={nodes:{},search:{origin:false}}},focus:function(){this.ctrls.inputs.fake.focus()},checkDisabled:function(){},disable:function(){},enable:function(){},setValue:function(e){this.hideDropdown();this.hideNothingFound();this.setFakeInputValue("");if(e==null||typeof e=="undefined"||e.toString().length==0){this.deselectItem();return}else if(e==this.vars.value)return;else this.setCurrentValue("");var t=this.vars,i=this.ctrls,s=this;this.discoverItems(function(){if(typeof t.cache.nodes[e]=="undefined")s.displayNothingFound();else s.selectItem(e)})},getValue:function(){return this.vars.value},clearSelected:function(){this.setValue("")},getNodeByValue:function(e){return this.vars.cache.nodes[e]},setTabIndex:function(e){this.ctrls.inputs.fake.setAttribute("tabindex",e)},setTargetInputName:function(e){this.ctrls.inputs.origin.setAttribute("name",e)},cancelRequest:function(){},setTargetInputValue:function(e){this.vars.eventLock=true;this.ctrls.inputs.origin.value=e;BX.fireEvent(this.ctrls.inputs.origin,"change");this.vars.eventLock=false},setFakeInputValue:function(e){var t=this.ctrls;if("value"in t.inputs.fake){BX.data(t.inputs.fake,"bx-dc-previous-value",e);t.inputs.fake.value=e}else{if(e=="")e=this.opts.messages.notSelected;t.inputs.fake.innerHTML=BX.util.htmlspecialchars(e)}},setValueVariable:function(e){this.vars.value=e},fillCache:function(e,t){var i=this.vars;if(!e.length)return;if(!BX.type.isPlainObject(t))t={};t.modifyOrigin=t.modifyOrigin||i.cache.search.origin===false;var s=t.modifyOriginPosition=="prepend"?"unshift":"push";if(i.cache.search.origin===false)i.cache.search.origin=[];for(var n in e){if(t.modifyOrigin){i.cache.search.origin[s](e[n].VALUE)}i.cache.nodes[e[n].VALUE]=e[n]}this.fireEvent("after-cache-filled",[])},getLastSource:function(){return this.vars.lastSource},toggleDropDown:function(){if(this.vars.allEventMutex)return;if(this.vars.opened)this.hideDropdown();else this.tryDisplayPage("toggle")},remove:function(){if(BX.type.isDomNode(this.ctrls.scope))this.ctrls.scope.innerHTML="";BX.unbindAll(this);if(this.vars.pager!=null){this.vars.pager.remove();this.vars.pager=null}if(this.vars.selector!=null){this.vars.selector.remove();this.vars.selector=null}},getLastPageIndex:function(){return Math.ceil(this.vars.filtered.length/this.opts.pageSize)-1},checkPageIsFirst:function(e){return e==0},checkPageIsLast:function(e){return e==this.getLastPageIndex()},checkPageIsOutOfRange:function(e){return e<0||e>this.getLastPageIndex()},setInitialValue:function(){var e=false;if(this.opts.selectedItem!==false)e=this.opts.selectedItem;else if(this.ctrls.inputs.origin.value.length>0)e=this.ctrls.inputs.origin.value;if(e!==false&&typeof e!="undefined")this.setValue(e)},discoverItems:function(e){var t=this.vars,i=this;var s=new BX.deferred;s.done(function(s){if(typeof s!="undefined")i.fillCache(s.items);t.loader.hide();t.allEventMutex=false;e.call(this)});s.fail(function(){t.loader.hide();t.allEventMutex=false;i.displayNothingFound()});if(BX.util.getObjectLength(t.cache.nodes)==0){t.loader.show();t.allEventMutex=true;s.startRace(1e3,false);this.fireEvent("item-list-discover",[s])}else s.resolve()},tryDisplayPage:function(e){var t=this.vars,i=this,s=this.ctrls.inputs.fake.value;t.applyFilter=e=="search"&&BX.type.isNotEmptyString(s);t.lastSource=e;this.discoverItems(function(){i.fireEvent("before-display-page",[]);var e=t.applyFilter?0:i.getPageNumberOfSelected();t.filtered=[];if(t.applyFilter){var n=s.toLowerCase();for(var r in t.cache.search.origin){var a=t.cache.search.origin[r];if(t.cache.nodes[a].DISPLAY.toLowerCase().indexOf(n)==0){t.filtered.push(a)}}}else t.filtered=t.cache.search.origin;if(t.filtered==false)t.filtered=[];t.pager.cleanUp();t.selector.cleanUp();i.displayPage(e)})},displayPage:function(e){var t=this.getPage(e);if(t.length==0)this.displayNothingFound();else{this.displayVariants(t,e)}},getPage:function(e){var t=this.vars,i=this.opts;return t.filtered.slice(e*i.pageSize,(e+1)*i.pageSize)},getPageNumberOfSelected:function(){if(this.vars.value==false)return 0;var e=this.vars;var t=0;for(var i in e.cache.search.origin){if(e.cache.search.origin[i]==this.vars.value)break;t++}if(t>e.cache.search.origin.length)return 0;return Math.floor(t/this.opts.pageSize)},displayNothingFound:function(){BX.cleanNode(this.ctrls.vars);if(BX.type.isElementNode(this.ctrls.nothingFound))this.whenNothingFoundToggle(true);else{var e=this.vars.pager;e.cleanUp();this.vars.selector.cleanUp();e.setTopReached();e.setBottomReached();e.appendPage(this.whenRenderNothingFound(this.opts.messages.nothingFound));this.showDropdown()}this.fireEvent("nothing-found")},displayVariants:function(e,t){var i=this.ctrls,s=this.vars,n=this.opts,r=this.sys.code;this.hideNothingFound();var a=[];var o=[];if(s.lastSource=="toggle"&&t==0&&s.value!==false){var l=this.createItemForPage("",{DISPLAY:n.messages.clearSelection},a,o);BX.addClass(l,"bx-ui-"+r+"-deselect-item")}var c={};for(var h in e){this.createItemForPage(e[h],s.cache.nodes[e[h]],a,o);c[s.cache.nodes[e[h]].VALUE]=a[h]}this.fireEvent("after-page-built",[t,a,o]);this.showDropdown();s.selector.addPage(o,t);if(this.checkPageIsLast(t))s.pager.setBottomReached();var u=this.vars.pager.getPageCount();s.pager.lockScrollEvents();s.pager.addPage(a,t);if(u==0){var d=false;if(s.value!==false){this.vars.selector.selectById(s.value);d=s.value}else{this.vars.selector.selectFirst();d=this.vars.selector.getSelected().id}if(d!==false&&typeof c[d]!="undefined"){this.vars.pager.scrollToNode(c[d])}}s.pager.unLockScrollEvents();s.pager.dispatchScrollEvents();this.fireEvent("after-page-display",[s.cache.nodes,t])},createItemForPage:function(e,t,i,s,n){var r=this.whenRenderVariant(t)[0];BX.data(r,"bx-"+this.sys.code+"-item-value",e);this.fireEvent("after-item-append",[r]);i[n?"unshift":"push"](r);s[n?"unshift":"push"]({id:e,data:{node:r}});return r},hideNothingFound:function(){if(BX.type.isElementNode(this.ctrls.nothingFound))this.whenNothingFoundToggle(false)},showDropdown:function(){if(this.vars.opened)return;if(this.vars.opened)return;var e=!this.vars.opened;this.vars.opened=true;BX.show(this.ctrls.dropdown);var t=BX.height(this.ctrls.dropdown);BX.hide(this.ctrls.dropdown);var i=this.ctrls.inputs.fake;var s=BX.pos(i);var n=BX.scrollTop(window)+BX.height(window)-(Math.ceil(s.top)+s.height);this.whenDropdownToggle.apply(this,[true,n-t<-20,s.height,e])},hideDropdown:function(){this.vars.opened=false;this.whenDropdownToggle.apply(this,[false,false,0,true])},deselectItem:function(){var e=this.vars,t=this.ctrls,i=this.opts;this.setCurrentValue("");this.fireEvent("after-deselect-item")},selectItem:function(e){var t=this.vars,i=this.ctrls,s=this.opts;t.value=e;i.inputs.origin.value=t.cache.nodes[e].VALUE;this.setFakeInputValue(this.whenItemSelect.apply(this,[e]));this.setCurrentValue(e);this.hideDropdown();this.fireEvent("after-select-item",[t.value])},setCurrentValue:function(e){var t=this.opts,i=this.vars;i.value=e==""?false:e;this.setTargetInputValue(e)},whenItemSelect:function(e){return this.vars.cache.nodes[e]["DISPLAY"]},whenToggleItemGlow:function(e,t){BX[t?"addClass":"removeClass"](e.node,"bx-ui-"+this.sys.code+"-variant-active")},whenDropdownToggle:function(e,t,i,s){if(e){if(s)this.whenDecideDropdownOrient(t,i,s);BX.show(this.ctrls.dropdown)}else BX.hide(this.ctrls.dropdown);this.fireEvent("after-popup-toggled",[e])},whenDecideDropdownOrient:function(e,t){var i=this.ctrls;if(e){var s=BX.style(i.dropdown,"top");if(s!="auto"){BX.data(i.dropdown,"pane-top",s)}BX.style(i.dropdown,"top","auto");BX.style(i.dropdown,"bottom",t+this.opts.pageUpWardOffset+"px")}else{var s=BX.data(i.dropdown,"pane-top");if(typeof s!="undefined")BX.style(i.dropdown,"top",s);BX.style(i.dropdown,"bottom","auto")}},whenNothingFoundToggle:function(e){BX[e?"show":"hide"](this.ctrls.nothingFound)},whenRenderError:function(e){if(typeof this.tmpls["error"]=="string")return this.createNodesByTemplate("error",{message:e},true)[0];return BX.create("div",{props:{className:"bx-ui-"+this.sys.code+"-error"},text:e})},whenRenderNothingFound:function(e){if(typeof this.tmpls["nothing-found"]=="string")return this.createNodesByTemplate("nothing-found",{message:e},true)[0];return this.whenRenderError(e)},whenLoaderToggle:function(e){this[e?"setCSSState":"dropCSSState"]("items-discover-in-progress")},whenRenderVariant:function(e){this.fireEvent("before-render-variant",[e]);if(typeof this.tmpls["dropdown-item"]=="string")return this.createNodesByTemplate("dropdown-item",e,true);return[BX.create("div",{props:{className:"bx-ui-"+this.sys.code+"-variant"},text:e.DISPLAY})]}});BX.ui.itemSelectManager=function(){this.selectFirst=function(){if(this.head!=null)this.selectById(this.head.id)};this.selectNext=function(e){this.jumpToDistance(true,e)};this.selectPrevious=function(e){this.jumpToDistance(false,e)};this.selectById=function(e){var t=this.data[e];if(typeof t=="undefined")return;if(this.current!=null)this.fireEvent("item-deselect",[this.current.id,this.current.data]);this.fireEvent("item-select",[e,t.data]);this.current=t};this.getSelected=function(){if(this.current==null)return undefined;return{id:this.current.id,data:this.current.data}};this.addPage=function(e,t){if(this.range==false){this.appendData(e);this.range=[t,t]}else if(t>this.range[1]){this.appendData(e);this.range[1]++}else if(t<this.range[0]){this.prependData(e);this.range[0]--}};this.cleanUp=function(){this.data={};this.head=null;this.tail=null;this.current=null;this.range=false};this.remove=function(){this.cleanUp()};this.fireEvent=function(e,t,i){i=i||this;t=t||[];BX.onCustomEvent(i,"bx-ui-item-select-manager-"+e,t)},this.bindEvent=function(e,t){BX.addCustomEvent(this,"bx-ui-item-select-manager-"+e,t)},this.jumpToDistance=function(e,t){if(this.current!=null){if(!t)t=1;var i=this.current;for(var s=0;s<t;s++){if(i[e?"next":"previous"]==null)break;i=i[e?"next":"previous"]}if(i!=null)this.selectById(i.id)}};this.appendData=function(e){for(var t=0;t<e.length;t++)this.append(e[t])};this.prependData=function(e){for(var t=e.length-1;t>=0;t--)this.prepend(e[t])};this.append=function(e){var t=this.tail;this.data[e.id]={id:e.id,data:e.data,next:null,previous:t};if(this.tail!=null)this.tail.next=this.data[e.id];if(this.head==null)this.head=this.data[e.id];this.tail=this.data[e.id];if(this.current==null)this.current=this.data[e.id]};this.prepend=function(e){var t=this.head;this.data[e.id]={id:e.id,data:e.data,next:t,previous:null};if(this.head!=null)this.head.previous=this.data[e.id];if(this.tail==null)this.tail=this.data[e.id];this.head=this.data[e.id];if(this.current==null)this.current=this.data[e.id]};this.cleanUp();return this};
/* End */
;
; /* Start:"a:4:{s:4:"full";s:63:"/bitrix/js/sale/core_ui_chainedselectors.min.js?143393738210357";s:6:"source";s:43:"/bitrix/js/sale/core_ui_chainedselectors.js";s:3:"min";s:47:"/bitrix/js/sale/core_ui_chainedselectors.min.js";s:3:"map";s:47:"/bitrix/js/sale/core_ui_chainedselectors.map.js";}"*/
BX.ui.chainedSelectors=function(e,t){this.parentConstruct(BX.ui.chainedSelectors,e);BX.merge(this,{opts:{source:"/somewhere.php",paginatedRequest:false,autoSelectWhenSingle:true,knownBundles:{},selectedItem:false,initialBundlesIncomplete:false,bundlesIncomplete:{},rootNodeValue:0,ignoreUnSelectable:false,adapterName:"combobox",messages:{nothingFound:"Sorry, nothing found",notSelected:"-- Not selected",error:"Error occured"},bindEvents:{init:function(){this.setInitialValue();this.vars.allowHideErrors=true}}},vars:{stack:[],cache:{links:{},nodes:{},incomplete:{}},value:false,eventLock:false,allowHideErrors:false},sys:{code:"chainedselectors"}});this.handleInitStack(t,BX.ui.chainedSelectors,e)};BX.extend(BX.ui.chainedSelectors,BX.ui.networkIOWidget);BX.merge(BX.ui.chainedSelectors.prototype,{init:function(){var e=this.opts,t=this.ctrls,n=this.vars;t.targetInput=this.getControl("target");t.errorMessage=this.getControl("error",true);t.pool=this.getControl("pool");if(typeof t.pool=="undefined")t.pool=t.scope;if(typeof e.knownBundles=="object"){this.fillCache(e.knownBundles);if(e.initialBundlesIncomplete){for(var s in e.knownBundles)n.cache.incomplete[s]=true}else if(typeof e.bundlesIncomplete!="undefined"){for(var s in e.knownBundles){if(typeof e.bundlesIncomplete[s]!="undefined")n.cache.incomplete[s]=true}}}this.pushFuncStack("buildUpDOM",BX.ui.chainedSelectors);this.pushFuncStack("bindEvents",BX.ui.chainedSelectors)},buildUpDOM:function(){},bindEvents:function(){var e=this,t=this.opts,n=this.vars,s=this.ctrls;this.bindEvent("control-change",this.controlChangeActions);BX.bind(s.targetInput,"change",function(){if(n.eventLock)return;e.setValue(this.value)})},addItems2Cache:function(){},clearCache:function(){},focus:function(){},checkDisabled:function(){},disable:function(){},enable:function(){},setValue:function(e){var t=this.vars;if(t.value!=false&&typeof e!="undefined"&&e==t.value)return;if(e==null||e==false||typeof e=="undefined"||e.toString().length==0){this.displayRoute([]);this.setValueVariable("");this.setTargetValue("");this.fireEvent("after-clear-selection");return}this.fireEvent("before-set-value",[e]);var n=new BX.deferred;var s=this;n.done(BX.proxy(function(n){this.displayRoute(n);t.value=e;this.setTargetValue(this.checkCanSelectItem(e)?e:this.getLastValidValue())},this));n.fail(function(e){if(e=="notfound"){s.displayRoute([]);s.setValueVariable("");s.setTargetValue("");s.showError({errors:[s.opts.messages.nothingFound],type:"server-logic",options:{}})}});this.hideError();this.getRouteToNode(e,n)},getValue:function(){return this.vars.value===false?"":this.vars.value},clearSelected:function(){this.setValue("")},getNodeByValue:function(e){return this.vars.cache.nodes[e]},setTabIndex:function(e){},setTargetInputName:function(e){this.ctrls.targetInput.setAttribute("name",e)},cancelRequest:function(){},getStackSize:function(){return this.vars.stack.length},getAdapterAtPosition:function(e){if(e<0||e>=this.vars.stack.length)return null;return this.vars.stack[e].control},setTargetInputValue:function(e){this.vars.eventLock=true;this.ctrls.targetInput.value=e;BX.fireEvent(this.ctrls.targetInput,"change");this.vars.eventLock=false},setFakeInputValue:function(e){},setValueVariable:function(e){this.vars.value=e},checkCanSelectItem:function(e){if(this.opts.ignoreUnSelectable)return true;var t=this.vars.cache.nodes;if(typeof t[e]=="undefined")return false;if(typeof t[e].IS_UNCHOOSABLE=="undefined")return true;return!t[e].IS_UNCHOOSABLE},controlChangeActions:function(e,t){var n=this,s=this.opts,i=this.vars,o=this.ctrls;this.hideError();if(t.length==0){n.truncateStack(e);i.value=n.getLastValidValue();n.setTargetValue(i.value)}else{var r=i.cache.nodes[t];if(typeof r=="undefined")throw new Error("Selected node not found in the cache");n.truncateStack(e);if(typeof i.cache.links[t]!="undefined"||r.IS_PARENT)n.appendControl(t);if(n.checkCanSelectItem(t)){i.value=t;n.setTargetValue(t)}}},setTargetValue:function(e){this.setTargetInputValue(e);this.fireEvent("after-select-item",[e])},getRouteToNodeFromCache:function(e){var t=[],n=this.vars;if(typeof n.cache.nodes[e]=="undefined")return t;var s=n.cache.nodes[e];t.unshift(s.VALUE);var i=0;var o=false;var r=BX.util.getObjectLength(n.cache.nodes);while(i<r){var a=s.PARENT_VALUE;if(a==this.opts.rootNodeValue)o=true;t.unshift(a);if(typeof a=="undefined"||a==this.opts.rootNodeValue||a=="0"){break}else{if(typeof n.cache.nodes[a]=="undefined")throw new Error("Tree integrity compromised");s=n.cache.nodes[a]}i++}return t},setInitialValue:function(){var e=false;if(this.opts.selectedItem!==false)e=this.opts.selectedItem;else if(this.ctrls.targetInput.value.length>0)e=this.ctrls.targetInput.value;this.setValue(e)},getRouteToNode:function(e,t){var n=this.vars,s=this;if(typeof e!="undefined"&&e!==false&&e.toString().length>0){var i=this.getRouteToNodeFromCache(e);if(i.length==0){s.downloadBundle({request:{VALUE:e},callbacks:{onLoad:function(i){for(var o in i){if(typeof n.cache.links[o]=="undefined")n.cache.incomplete[o]=true}s.fillCache(i,true);var r=s.getRouteToNodeFromCache(e);if(r.length==0)t.reject("notfound");else t.resolve(r)},onError:function(){t.reject("internal")}},options:{}})}else t.resolve(i)}else t.resolve([])},getBundleForNode:function(e,t){var n=this.vars,s=this;if(typeof e!="undefined"&&e!==false&&e.toString().length>0){if(typeof this.vars.cache.links[e]=="undefined"||this.vars.cache.incomplete[e]===true){s.downloadBundle({request:{PARENT_VALUE:e},callbacks:{onLoad:function(i){s.fillCache(i);if(typeof this.vars.cache.links[e]=="undefined"){t.reject()}else{delete n.cache.incomplete[e];t.resolve(this.vars.cache.links[e])}},onError:function(){t.reject()}},options:{}})}else t.resolve(this.vars.cache.links[e])}else t.resolve([])},displayRoute:function(e){var t=this.vars;this.truncateStack(-1);if(e.length==0)this.appendControl(this.opts.rootNodeValue);else{e=BX.clone(e);for(var n=0;n<e.length;n++){var s=e[n];if(typeof t.cache.links[s]!="undefined"||t.cache.nodes[s].IS_PARENT){this.appendControl(s,e[n+1])}}}},appendControl:function(e,t){var n={parent:this,messages:this.opts.messages};if(typeof t!="undefined")n.selectedItem=t;n.parentNode=e;if(typeof this.vars.cache.links[e]!="undefined"){n.knownItems=[];for(var s in this.vars.cache.links[e])n.knownItems.push(this.vars.cache.nodes[this.vars.cache.links[e][s]])}var i=new BX.ui.chainedSelectors.adapters[this.opts.adapterName](n);i.setIndex(this.vars.stack.length);this.vars.stack.push({control:i})},setNextValidValue:function(e,t){var n=this.vars,s=this.opts,i=this.ctrls;var o=typeof n.cache.links[t]!="undefined";var r=n.cache.links[t].length;if(s.autoSelectWhenSingle&&e.IS_PARENT&&o&&r==1){var a=this.getLastControl().control;a.value=n.cache.links[t][0];BX.fireEvent(a,"change")}else{this.setTargetValue(e.IS_UNCHOOSABLE?this.getLastValidValue():t)}},getLastValidValue:function(){var e=undefined,t=this.ctrls,n=this.vars;for(var s=n.stack.length-1;s>=0;s--){e=n.stack[s].control.getValue();if(typeof e!="undefined"&&typeof n.cache.nodes[e]!="undefined"&&typeof n.cache.nodes[e].IS_UNCHOOSABLE=="undefined")return e}return""},getLastControl:function(){return this.vars.stack[this.vars.stack.length-1]},truncateStack:function(e){if(e<-1)return;var t=this.vars.stack.length;for(var n=e+1;n<t;n++){this.vars.stack[n].control.remove()}this.vars.stack.splice(e+1,t-(e+1))},getSelectorValue:function(e){return e},fillCache:function(e,t){var n=this.vars,s=this.opts;for(var i in e){if(typeof n.cache.links[i]=="undefined"||n.cache.incomplete[i]===true){if(typeof n.cache.links[i]=="undefined"||!t)n.cache.links[i]=[];for(var o in e[i]){n.cache.links[i].push(e[i][o].VALUE);e[i][o].PARENT_VALUE=i;this.addItem2Cache(e[i][o])}}}},addItem2Cache:function(e){this.vars.cache.nodes[e.VALUE]=e},getCurrentItem:function(){return this.vars.cache.nodes[this.vars.value]},setTargetInputName:function(e){this.ctrls.targetInput.setAttribute("name",e)},showError:function(e){this.setCSSState("error",this.ctrls.scope);if(BX.type.isElementNode(this.ctrls.errorMessage)){this.ctrls.errorMessage.innerHTML=BX.util.htmlspecialchars(e.errors.join(", "));BX.show(this.ctrls.errorMessage)}BX.debug(e)},hideError:function(){if(this.vars.allowHideErrors){this.dropCSSState("error",this.ctrls.scope);if(BX.type.isElementNode(this.ctrls.errorMessage))BX.hide(this.ctrls.errorMessage)}}});BX.ui.chainedSelectors.adapters={};BX.ui.chainedSelectors.adapters.combobox=function(e){this.opts=e;this.control=null;this.scope=null;this.index=null;this.place=function(){var t=this;this.scope=this.opts.parent.createNodesByTemplate("selector-scope",{},true)[0];BX.append(this.scope,this.opts.parent.ctrls.pool);e.scope=this.scope;e.arrowScrollAdditional=5;e.focusOnMouseSelect=false;this.opts.parent.fireEvent("before-control-placed",[this]);this.control=new BX.ui.combobox(e);this.control.vars.outSideClickScope=this.scope;this.control.bindEvent("item-list-discover",BX.proxy(function(e){e.stopRace();var t=new BX.deferred;t.done(BX.proxy(function(t){var n=[];for(var s in t)n.push(this.opts.parent.vars.cache.nodes[t[s]]);this.opts.parent.fireEvent("before-control-item-discover-done",[n,this]);e.resolve({items:n})},this));this.opts.parent.getBundleForNode(this.opts.parentNode,t)},this));this.control.bindEvent("before-display-page",function(){t.opts.parent.fireEvent("control-before-display-page",[t])});this.control.bindEvent("after-select-item",BX.proxy(function(e){this.opts.parent.fireEvent("control-change",[this.index,e])},this));this.control.bindEvent("after-deselect-item",BX.proxy(function(){this.opts.parent.fireEvent("control-change",[this.index,""])},this));if(this.opts.parent.vars.cache.incomplete[this.opts.parentNode])this.control.clearCache();this.opts.parent.fireEvent("after-control-placed",[this])};this.remove=function(){this.control.remove();this.control=null;this.opts=null;BX.remove(this.scope);this.scope=null};this.setIndex=function(e){this.index=e};this.getIndex=function(){return this.index};this.getValue=function(){return this.control.getValue()};this.getParentValue=function(){return this.opts.parentNode};this.getControl=function(){return this.control};this.setValuePair=function(e,t){this.control.setTargetInputValue(e);this.control.setFakeInputValue(t);this.control.setValueVariable(e)};this.place();return this};
/* End */
;
//# sourceMappingURL=kernel_sale.map.js