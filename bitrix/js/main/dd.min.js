(function(){if(window.jsDD)return;jsDD={arObjects:[],arDestinations:[],arDestinationsPriority:[],arContainers:[],arContainersPos:[],current_dest_index:false,current_node:null,wndSize:null,bStarted:false,bDisable:false,bDisableDestRefresh:false,bEscPressed:false,bScrollWindow:false,scrollViewTimer:null,scrollViewConfig:{checkerTimeout:30,scrollZone:25,scrollBy:25,scrollContainer:null,bScrollH:true,bScrollV:true,pos:null},setScrollWindow:function(e){jsDD.bScrollWindow=!!e;if(BX.type.isDomNode(e)){jsDD.scrollViewConfig.scrollContainer=e;jsDD.scrollViewConfig.pos=BX.pos(e);var s=BX.style(e,"overflow")||"visible",D=BX.style(e,"overflow-x")||"visible",r=BX.style(e,"overflow-y")||"visible";jsDD.scrollViewConfig.bScrollH=s!="visible"||D!="visible";jsDD.scrollViewConfig.bScrollV=s!="visible"||r!="visible"}},Reset:function(){jsDD.arObjects=[];jsDD.arDestinations=[];arDestinationsPriority=[];jsDD.bStarted=false;jsDD.current_node=null;jsDD.current_dest_index=false;jsDD.bDisableDestRefresh=false;jsDD.bDisable=false;jsDD.x=null;jsDD.y=null;jsDD.start_x=null;jsDD.start_y=null;jsDD.wndSize=null;jsDD.bEscPressed=false;clearInterval(jsDD.scrollViewTimer);jsDD.bScrollWindow=false;jsDD.scrollViewTimer=null;jsDD.scrollViewConfig.scrollContainer=null},registerObject:function(e){e.onmousedown=jsDD.startDrag;e.__bxddid=jsDD.arObjects.length;jsDD.arObjects[e.__bxddid]=e},unregisterObject:function(e){if(typeof e["__bxddid"]==="undefined"){return}delete jsDD.arObjects[e.__bxddid];delete e.__bxddid;delete e.onmousedown},registerDest:function(e,s){if(!s)s=100;e.__bxddeid=jsDD.arDestinations.length;e.__bxddpriority=s;jsDD.arDestinations[e.__bxddeid]=e;if(!jsDD.arDestinationsPriority[s])jsDD.arDestinationsPriority[s]=[e.__bxddeid];else jsDD.arDestinationsPriority[s].push(e.__bxddeid);jsDD.refreshDestArea(e.__bxddeid)},unregisterDest:function(e){if(typeof e["__bxddeid"]==="undefined"){return}delete jsDD.arDestinations[e.__bxddeid];delete e.__bxddeid;delete e.__bxddpriority;jsDD.refreshDestArea()},disableDest:function(e){if(typeof e.__bxddeid!=="undefined"){e.__bxdddisabled=true}},enableDest:function(e){if(typeof e.__bxddeid!=="undefined"){e.__bxdddisabled=false}},registerContainer:function(e){jsDD.arContainers[jsDD.arContainers.length]=e},getContainersScrollPos:function(e,s){var D={left:0,top:0};for(var r=0,n=jsDD.arContainers.length;r<n;r++){if(jsDD.arContainers[r]&&e>=jsDD.arContainersPos[r]["left"]&&e<=jsDD.arContainersPos[r]["right"]&&s>=jsDD.arContainersPos[r]["top"]&&s<=jsDD.arContainersPos[r]["bottom"]){D.left=jsDD.arContainers[r].scrollLeft;D.top=jsDD.arContainers[r].scrollTop}}return D},setContainersPos:function(){for(var e=0,s=jsDD.arContainers.length;e<s;e++){if(jsDD.arContainers[e])jsDD.arContainersPos[e]=BX.pos(jsDD.arContainers[e])}},refreshDestArea:function(e){if(e&&typeof e=="object"&&typeof e.__bxddeid!="undefined"){e=e.__bxddeid}if(typeof e=="undefined"){for(var s=0,D=jsDD.arDestinations.length;s<D;s++){jsDD.refreshDestArea(s)}}else{if(null==jsDD.arDestinations[e])return;var r=BX.pos(jsDD.arDestinations[e]);jsDD.arDestinations[e].__bxpos=[r.left,r.top,r.right,r.bottom]}},_checkEsc:function(e){e=e||window.event;if(jsDD.bStarted&&e.keyCode==27){jsDD.stopCurrentDrag()}},stopCurrentDrag:function(){if(jsDD.bStarted){jsDD.bEscPressed=true;jsDD.stopDrag()}},_onscroll:function(){jsDD.wndSize=BX.GetWindowSize()},_checkScroll:function(){if(jsDD.bScrollWindow){var e={clientX:jsDD.x-jsDD.wndSize.scrollLeft,clientY:jsDD.y-jsDD.wndSize.scrollTop},s=false,D=jsDD.scrollViewConfig.scrollZone;if(e.clientY<D&&jsDD.wndSize.scrollTop>0){window.scrollBy(0,-jsDD.scrollViewConfig.scrollBy);s=true}if(e.clientY>jsDD.wndSize.innerHeight-D&&jsDD.wndSize.scrollTop<jsDD.wndSize.scrollHeight-jsDD.wndSize.innerHeight){window.scrollBy(0,jsDD.scrollViewConfig.scrollBy);s=true}if(e.clientX<D&&jsDD.wndSize.scrollLeft>0){window.scrollBy(-jsDD.scrollViewConfig.scrollBy,0);s=true}if(e.clientX>jsDD.wndSize.innerWidth-D&&jsDD.wndSize.scrollLeft<jsDD.wndSize.scrollWidth-jsDD.wndSize.innerWidth){window.scrollBy(jsDD.scrollViewConfig.scrollBy,0);s=true}if(jsDD.scrollViewConfig.scrollContainer){var r=jsDD.scrollViewConfig.scrollContainer;if(jsDD.scrollViewConfig.bScrollH){if(e.clientX+jsDD.wndSize.scrollLeft<jsDD.scrollViewConfig.pos.left+D&&r.scrollLeft>0){r.scrollLeft-=jsDD.scrollViewConfig.scrollBy;s=true}if(e.clientX+jsDD.wndSize.scrollLeft>jsDD.scrollViewConfig.pos.right-D&&r.scrollLeft<r.scrollWidth-r.offsetWidth){r.scrollLeft+=jsDD.scrollViewConfig.scrollBy;s=true}}if(jsDD.scrollViewConfig.bScrollV){if(e.clientY+jsDD.wndSize.scrollTop<jsDD.scrollViewConfig.pos.top+D&&r.scrollTop>0){r.scrollTop-=jsDD.scrollViewConfig.scrollBy;s=true}if(e.clientY+jsDD.wndSize.scrollTop>jsDD.scrollViewConfig.pos.bottom-D&&r.scrollTop<r.scrollHeight-r.offsetHeight){r.scrollTop+=jsDD.scrollViewConfig.scrollBy;s=true}}}if(s){jsDD._onscroll();jsDD.drag(e)}}},startDrag:function(e){if(jsDD.bDisable)return true;e=e||window.event;if(!(BX.getEventButton(e)&BX.MSLEFT))return true;jsDD.current_node=null;if(e.currentTarget){jsDD.current_node=e.currentTarget;if(null==jsDD.current_node||null==jsDD.current_node.__bxddid){jsDD.current_node=null;return}}else{jsDD.current_node=e.srcElement;if(null==jsDD.current_node)return;while(null==jsDD.current_node.__bxddid){jsDD.current_node=jsDD.current_node.parentNode;if(jsDD.current_node.tagName=="BODY")return}}jsDD.bStarted=false;jsDD.bPreStarted=true;jsDD.wndSize=BX.GetWindowSize();jsDD.start_x=e.clientX+jsDD.wndSize.scrollLeft;jsDD.start_y=e.clientY+jsDD.wndSize.scrollTop;BX.bind(document,"mouseup",jsDD.stopDrag);BX.bind(document,"mousemove",jsDD.drag);BX.bind(window,"scroll",jsDD._onscroll);if(document.body.setCapture)document.body.setCapture();jsDD.denySelection();if(!jsDD.bDisableDestRefresh)jsDD.refreshDestArea();jsDD.setContainersPos();return BX.PreventDefault(e)},start:function(){if(jsDD.bDisable)return true;document.body.style.cursor="move";if(jsDD.current_node.onbxdragstart)jsDD.current_node.onbxdragstart();for(var e=0,s=jsDD.arDestinations.length;e<s;e++){if(jsDD.arDestinations[e].onbxdestdragstart)jsDD.arDestinations[e].onbxdestdragstart(jsDD.current_node)}jsDD.bStarted=true;jsDD.bPreStarted=false;if(jsDD.bScrollWindow){if(jsDD.scrollViewTimer)clearInterval(jsDD.scrollViewTimer);jsDD.scrollViewTimer=setInterval(jsDD._checkScroll,jsDD.scrollViewConfig.checkerTimeout)}BX.bind(document,"keypress",this._checkEsc)},drag:function(e){if(jsDD.bDisable)return true;e=e||window.event;jsDD.x=e.clientX+jsDD.wndSize.scrollLeft;jsDD.y=e.clientY+jsDD.wndSize.scrollTop;var s=5;if(jsDD.x>=jsDD.start_x-s&&jsDD.x<=jsDD.start_x+s&&jsDD.y>=jsDD.start_y-s&&jsDD.y<=jsDD.start_y+s)return true;if(!jsDD.bStarted)jsDD.start();if(jsDD.current_node.onbxdrag){jsDD.current_node.onbxdrag(jsDD.x,jsDD.y)}var D=jsDD.getContainersScrollPos(jsDD.x,jsDD.y);var r=jsDD.searchDest(jsDD.x+D.left,jsDD.y+D.top);if(r!==jsDD.current_dest_index){if(jsDD.current_dest_index!==false){if(jsDD.current_node.onbxdraghout)jsDD.current_node.onbxdraghout(jsDD.arDestinations[jsDD.current_dest_index],jsDD.x,jsDD.y);if(jsDD.arDestinations[jsDD.current_dest_index].onbxdestdraghout)jsDD.arDestinations[jsDD.current_dest_index].onbxdestdraghout(jsDD.current_node,jsDD.x,jsDD.y)}if(r!==false){if(jsDD.current_node.onbxdraghover)jsDD.current_node.onbxdraghover(jsDD.arDestinations[r],jsDD.x,jsDD.y);if(jsDD.arDestinations[r].onbxdestdraghover)jsDD.arDestinations[r].onbxdestdraghover(jsDD.current_node,jsDD.x,jsDD.y)}}jsDD.current_dest_index=r},stopDrag:function(e){BX.unbind(document,"keypress",jsDD._checkEsc);e=e||window.event;jsDD.bPreStarted=false;if(jsDD.bStarted){if(!jsDD.bEscPressed){jsDD.x=e.clientX+jsDD.wndSize.scrollLeft;jsDD.y=e.clientY+jsDD.wndSize.scrollTop}if(null!=jsDD.current_node.onbxdragstop)jsDD.current_node.onbxdragstop(jsDD.x,jsDD.y);var s=jsDD.getContainersScrollPos(jsDD.x,jsDD.y);var D=jsDD.searchDest(jsDD.x+s.left,jsDD.y+s.top);if(false!==D){if(jsDD.bEscPressed){if(null!=jsDD.arDestinations[D].onbxdestdraghout){if(!jsDD.arDestinations[D].onbxdestdraghout(jsDD.current_node,jsDD.x,jsDD.y))D=false;else{if(null!=jsDD.current_node.onbxdragfinish)jsDD.current_node.onbxdragfinish(jsDD.arDestinations[D],jsDD.x,jsDD.y)}}}else{if(null!=jsDD.arDestinations[D].onbxdestdragfinish){if(!jsDD.arDestinations[D].onbxdestdragfinish(jsDD.current_node,jsDD.x,jsDD.y,e))D=false;else{if(null!=jsDD.current_node.onbxdragfinish)jsDD.current_node.onbxdragfinish(jsDD.arDestinations[D],jsDD.x,jsDD.y)}}}}if(false===D){if(null!=jsDD.current_node.onbxdragrelease)jsDD.current_node.onbxdragrelease(jsDD.x,jsDD.y)}else{for(var r=0,n=jsDD.arDestinations.length;r<n;r++){if(r!=D&&null!=jsDD.arDestinations[r].onbxdestdragrelease)jsDD.arDestinations[r].onbxdestdragrelease(jsDD.current_node,jsDD.x,jsDD.y)}}for(var r=0,n=jsDD.arDestinations.length;r<n;r++){if(null!=jsDD.arDestinations[r].onbxdestdragstop)jsDD.arDestinations[r].onbxdestdragstop(jsDD.current_node,jsDD.x,jsDD.y)}}if(document.body.releaseCapture)document.body.releaseCapture();BX.unbind(window,"scroll",jsDD._onscroll);BX.unbind(document,"mousemove",jsDD.drag);BX.unbind(document,"keypress",jsDD._checkEsc);BX.unbind(document,"mouseup",jsDD.stopDrag);jsDD.allowSelection();document.body.style.cursor="";jsDD.current_node=null;jsDD.current_dest_index=false;if(jsDD.bScrollWindow){if(jsDD.scrollViewTimer)clearInterval(jsDD.scrollViewTimer)}if(jsDD.bStarted&&!jsDD.bDisableDestRefresh)jsDD.refreshDestArea();jsDD.bStarted=false;jsDD.bEscPressed=false},searchDest:function(e,s){var D,r,n,t,o;for(D=0,r=jsDD.arDestinationsPriority.length;D<r;D++){if(jsDD.arDestinationsPriority[D]&&BX.type.isArray(jsDD.arDestinationsPriority[D])){for(n=0,t=jsDD.arDestinationsPriority[D].length;n<r;n++){o=jsDD.arDestinationsPriority[D][n];if(jsDD.arDestinations[o]&&!jsDD.arDestinations[o].__bxdddisabled){if(jsDD.arDestinations[o].__bxpos[0]<=e&&jsDD.arDestinations[o].__bxpos[2]>=e&&jsDD.arDestinations[o].__bxpos[1]<=s&&jsDD.arDestinations[o].__bxpos[3]>=s){return o}}}}}return false},allowSelection:function(){document.onmousedown=null;var e=document.body;e.ondrag=null;e.onselectstart=null;e.style.MozUserSelect="";if(jsDD.current_node){jsDD.current_node.ondrag=null;jsDD.current_node.onselectstart=null;jsDD.current_node.style.MozUserSelect=""}},denySelection:function(){document.onmousedown=BX.False;var e=document.body;e.ondrag=BX.False;e.onselectstart=BX.False;e.style.MozUserSelect="none";if(jsDD.current_node){jsDD.current_node.ondrag=BX.False;jsDD.current_node.onselectstart=BX.False;jsDD.current_node.style.MozUserSelect="none"}},Disable:function(){jsDD.bDisable=true},Enable:function(){jsDD.bDisable=false}}})();
//# sourceMappingURL=dd.map.js